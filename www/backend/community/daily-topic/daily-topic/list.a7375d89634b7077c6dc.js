webpackJsonp([182],{"6qeJ":function(t,e,i){var o=i("s/u3");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i("rjj0")("0e527eaf",o,!0)},UrvW:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("m-page-list",{attrs:{path:t.api.path,params:t.api.params,columns:t.columns,methods:t.methods,"response-handle":t.responseHandle,"page-info-path":t.pageInfoApi.path,"page-info-params":t.pageInfoApi.params,listData:t.listData},on:{"on-selection-change":t.selectionChange}},[i("m-action-bar",{attrs:{slot:"search"},slot:"search"},[i("m-action-search-bar",{attrs:{"search-condition":t.searchCondition,"search-condition-handle":t.searchConditionHandle}},[i("m-form-item",{staticClass:"form-item"},[i("i-input",{staticStyle:{width:"100px"},attrs:{placeholder:"帖子id"},model:{value:t.searchCondition.topic_id,callback:function(e){t.$set(t.searchCondition,"topic_id",e)},expression:"searchCondition.topic_id"}})],1),t._v(" "),i("m-form-item",{staticClass:"form-item"},[i("i-input",{attrs:{placeholder:"帖子内容搜索"},model:{value:t.searchCondition.keyword,callback:function(e){t.$set(t.searchCondition,"keyword",e)},expression:"searchCondition.keyword"}})],1),t._v(" "),i("m-form-item",{staticClass:"form-item"},[i("DatePicker",{staticStyle:{width:"150px"},attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm",placeholder:"话题上线日期"},model:{value:t.dateTimeRange,callback:function(e){t.dateTimeRange=e},expression:"dateTimeRange"}})],1),t._v(" "),i("m-form-item",{staticClass:"form-item"},[i("Select",{staticStyle:{width:"100px"},attrs:{placeholder:"状态"},model:{value:t.searchCondition.status,callback:function(e){t.$set(t.searchCondition,"status",e)},expression:"searchCondition.status"}},[i("Option",{attrs:{value:""}},[t._v("所有")]),t._v(" "),i("Option",{attrs:{value:"1"}},[t._v("未生效")]),t._v(" "),i("Option",{attrs:{value:"2"}},[t._v("当前线上")]),t._v(" "),i("Option",{attrs:{value:"3"}},[t._v("已失效")])],1)],1)],1)],1),t._v(" "),i("m-action-bar",[i("m-action-button-add",{attrs:{route:t.addRoute}})],1)],1)},staticRenderFns:[]}},f73c:function(t,e,i){i("6qeJ");var o=i("VU/8")(i("klNs"),i("UrvW"),"data-v-16d8bad5",null);t.exports=o.exports},klNs:function(t,e,i){"use strict";function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t){return t=new Date(t),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}Object.defineProperty(e,"__esModule",{value:!0});var s={props:{type:"text",size:"small"},style:{display:"block",color:"#39f",padding:0}},a={style:{display:"block",color:"#666"}};e.default={name:"list",data:function(){var t,e=this;return t={addRoute:"/backend/#/community/daily-topic/daily-topic/add",showRecommendModal:!1,recommendId:"",showChangeTopicGroupButton:!1,showChangeTopicGroupModal:!1,topicIdsSelectedToChangeGroup:"",listData:[],idsSelected:"",batchRemoveSubmitButton:"none"},o(t,"addRoute","/community/daily-topic/daily-topic/add"),o(t,"editRoute","/community/daily-topic/daily-topic/edit"),o(t,"sourceList",[]),o(t,"cateTree",[]),o(t,"deleteReasonList",["广告内容","发布微信号等其他账号导流","黄反信息","不符合当前版规","其他原因","不发送小秘书"]),o(t,"showDeleteReasonBox",!1),o(t,"imageComment",!0),o(t,"commentParam",{commentId:"",reply_id:""}),o(t,"showReplyModal",!1),o(t,"removeApi",{path:"/boss/community/topic/topic/topics",params:{ids:"",reason:""}}),o(t,"replyApi",{path:"/boss/community/topic/comment/reply",params:{}}),o(t,"cancelRecommendApi",{path:"/boss/community/topic/topic_channel/topics",params:{topic_ids:""}}),o(t,"api",{path:"/boss/community/topic/daily_topics",params:{base_fields:"total_count,list[].topic_id,list[].title,list[].content_html,list[].status,list[].is_free,list[].share_id,list[].author.uid,list[].author.avatar.s(180),list[].author.nickname,list[].create_time,list[].comment_count,list[].is_top,list[].is_hot,list[].collect_count,list[].praise_count,list[].is_hide,list[].group.nickname,list[].group.type,list[].group.name,list[].view_count,list[].is_first,list[].images[].s(320),list[].recommend_time,list[].deleted_reason",limit:24,offset:0}}),o(t,"pageInfoApi",{path:"/boss/community/topic/daily_topic/page_info",params:{}}),o(t,"selectOptionsApi",{path:"/boss/community/topic/topic/form_params",params:{}}),o(t,"searchCondition",{topic_id:"",keyword:"",status:"",show_time:""}),o(t,"dateTimeRange",0),o(t,"columns",[{title:"话题",render:function(t,e){var i=e.row;return t("div",a,i.title)}},{title:"id",render:function(t,e){var i=e.row;return t("div",a,i.topic_id)}},{title:"话题上线日期",width:"200px",render:function(t,e){var i=e.row;return t("div",a,n(1e3*i.daily_info.show_start_time))}},{title:"发布日期",render:function(t,e){var i=e.row;return t("div",a,n(1e3*i.daily_info.create_time))}},{title:"状态",render:function(t,i){var o=i.row,n=e.createStateStr(o.daily_info);return t("div",{style:n.style},n.text)}},{title:"数据",render:function(t,e){var i=[],o=e.row;o.topic_id;return i[0]=t("span",{props:{type:"text",size:"small"},style:{display:"block",color:"#333",padding:0}},"收藏数 "+o.praise_count),i[1]=t("span",{props:{type:"text",size:"small"},style:{display:"block",color:"#333",padding:0}},"点赞数 "+o.praise_count),i[2]=t("Button",Object.assign({props:{type:"text",size:"small"},style:{display:"block",color:"#39f",padding:0}},{on:{click:function(){window.open("/backend/#/community/topic/comment/list/"+o.topic_id)}}}),"评论数 "+o.comment_count),i[3]=t("span",{props:{type:"text",size:"small"},style:{display:"block",color:"#333",padding:0}},"阅读数 "+o.view_count),t("div",i)}},{title:"操作",render:function(t,i){var o=[],n=i.row,a=n.topic_id;return o[0]=t("Button",Object.assign(s,{on:{click:function(){e.review(a)}}}),"H5预览"),o[1]=t("Button",Object.assign(s,{on:{click:function(){e.toEdit(n.daily_info.id)}}}),"编辑"),o[2]=t("Button",Object.assign(s,{on:{click:function(){e.toRemove(n.daily_info.id)}}}),"隐藏"),t("div",o)}}]),t},methods:{createStateStr:function(t){var e=~~((new Date).getTime()/1e3),i=t.status;return 1===i&&t.show_start_time>e?{style:{display:"block",color:"black"},text:"未生效"}:1===i&&t.show_start_time<e&&t.show_end_time>e?{style:{display:"block",color:"green"},text:"当前线上"}:{style:{display:"block",color:"red"},text:"已失效"}},hideRecommendModal:function(){this.showRecommendModal=!1},responseHandle:function(t,e){return t.data.map(function(t,i){t.show_time=e.$Util.dateFormat(t.show_time,"yyyy-MM-dd hh:mm:ss")}),this.listData=t.data,t},toAdd:function(){window.location.hash=this.addRoute},toEdit:function(t){window.location.hash=this.editRoute+"/"+t},review:function(t){window.open("https://m.meijiabang.cn/#!topic/"+t,"","width=375,height=667")},toRemove:function(t){var e={path:"/boss/community/topic/daily_topics/"+t};confirm("确认移除?")&&(bus.$emit("on-loading"),this.$Util.api.delete({api:e},this).then(function(){location.reload()},function(t){alert(t)}))},toRecommend:function(t){this.showRecommendModal=!0,this.recommendId=t},submitReply:function(){this.showReplyModal=!1},cancelRecommend:function(t){this.cancelRecommendApi.params.topic_ids=t,vm.$Util.api.delete({api:this.cancelRecommendApi},vm).then(function(t){0===t.error_code?this.$Message.info("已取消推荐"):this.$Message.warning(t.error_description)},function(t){this.$Message.error("取消失败")})},paddingData:function(){this.$Util.api.get({api:this.selectOptionsApi},this).then(function(t){var e=this;0===t.error_code&&(e.cateTree=t.data.cate_tree,e.sourceList=t.data.source)},function(t){})},searchConditionHandle:function(t){return t.show_time=isNaN(Date.parse(this.dateTimeRange))?"":Date.parse(this.dateTimeRange)/1e3,t},showUserInfo:function(t){t&&window.open("/admin.php?uid="+t+"&m=Admin&c=User&c=User&a=index")},closeReply:function(){this.showReplyModal=!1},prepareToBatchRemove:function(){4==this.columns.length&&this.columns.unshift({type:"selection",width:30,align:"center"}),this.batchRemoveSubmitButton=""},cancelBatchRemove:function(){this.batchRemoveSubmitButton="none",5==this.columns.length&&this.columns.shift(),this.cancelSelect()},cancelSelect:function(){var t=[];this.listData.map(function(e){e._checked=!1,t.push(e)}),this.listData=t},batchRemove:function(){this.showDeleteReasonBox=!0},selectionChange:function(t){var e=[];t.map(function(t){e.push(t.topic_id)}),this.idsSelected=e.join(",")},prepareToChangeTopicGroup:function(){this.showChangeTopicGroupModal=!1,this.idsSelected?(this.topicIdsSelectedToChangeGroup=this.idsSelected,this.showChangeTopicGroupModal=!0):this.$Message.warning("请勾选要转移的帖子")},toShowChangeButton:function(){this.showChangeTopicGroupButton=!0,4==this.columns.length&&this.columns.unshift({type:"selection",width:30,align:"center"})},cancelChangeTopicGroup:function(){this.showChangeTopicGroupButton=!this.showChangeTopicGroupButton,5==this.columns.length&&this.columns.shift(),this.cancelSelect()},changeTopicGroupFinished:function(){this.cancelSelect(),this.showChangeTopicGroupButton=!this.showChangeTopicGroupButton,this.showChangeTopicGroupModal=!1,5==this.columns.length&&this.columns.shift()}},created:function(){this.$nextTick(function(){this.paddingData()})}}},"s/u3":function(t,e,i){e=t.exports=i(0)(),e.push([t.i,".form-item[data-v-16d8bad5]{margin:6px 10px 0 0}",""])}});