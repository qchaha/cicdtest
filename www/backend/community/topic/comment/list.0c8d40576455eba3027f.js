webpackJsonp([45],{DHNN:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"MReplyModal",props:{path:{type:String,default:""},title:{type:String,default:""},commentParam:{type:String,default:{commentId:"",share_id:"",topic_id:""}},isVisible:{type:Boolean,default:!1},imageComment:{type:Boolean,default:!1}},data:function(){return{responseData:{},addQuickReplyBox:!1,backendAccount:[{}],account:"back",commentContent:"",user:"",image:{},showExpression:!1,nextPage:!1,emoticonsPath:"http://m.meijiabang.cn/img/emoticons/",expressionImgs:[[{fileName:"keai_2x.png",title:"可爱"},{fileName:"touxiao_2x.png",title:"偷笑"},{fileName:"deyi_2x.png",title:"得意"},{fileName:"ku_2x.png",title:"酷"},{fileName:"memeda_2x.png",title:"么么哒"},{fileName:"huachi_2x.png",title:"花痴"},{fileName:"ding_2x.png",title:"顶"},{fileName:"zan_2x.png",title:"赞"},{fileName:"haixiu_2x.png",title:"害羞"},{fileName:"mogui_2x.png",title:"魔鬼"},{fileName:"liuhan_2x.png",title:"流汗"},{fileName:"guzhang_2x.png",title:"鼓掌"},{fileName:"weiqv_2x.png",title:"委屈"},{fileName:"outu_2x.png",title:"呕吐"},{fileName:"kuqi_2x.png",title:"哭泣"},{fileName:"kuaikule_2x.png",title:"快哭了"},{fileName:"lianhong_2x.png",title:"脸红"},{fileName:"jingxia_2x.png",title:"惊吓"},{fileName:"yiwen_2x.png",title:"疑问"},{fileName:"hua_2x.png",title:"献花"},{fileName:"shaxiao_2x.png",title:"傻笑"}],[{fileName:"bianbian_2x.png",title:"便便"},{fileName:"biezui_2x.png",title:"瘪嘴"},{fileName:"bishi.png",title:"鄙视"},{fileName:"chiyao_2x.png",title:"吃药"},{fileName:"dage_2x.png",title:"打嗝"},{fileName:"fendou_2x.png",title:"奋斗"},{fileName:"haqian_2x.png",title:"哈欠"},{fileName:"jin_2x.png",title:"禁"},{fileName:"jinzhang_2x.png",title:"紧张"},{fileName:"jiong_2x.png",title:"囧"},{fileName:"kule.png",title:"哭"},{fileName:"lei_2x.png",title:"雷"},{fileName:"ma_2x.png",title:"骂"},{fileName:"nu_2x.png",title:"怒"},{fileName:"qidao_2x.png",title:"祈祷"},{fileName:"se_2x.png",title:"色"},{fileName:"tu_2x.png",title:"吐"},{fileName:"xigua_2x.png",title:"西瓜"},{fileName:"yun_2x.png",title:"晕"},{fileName:"zhuakuang_2x.png",title:"抓狂"}]],quickReplyList:[],quickReplyListApi:{path:"/boss/community/topic/comment/reply_temps"},addQuickReplyApi:{path:"/boss/community/topic/comment/reply_temps",params:{reply:""}},removeQuickReplyApi:{path:"/boss/community/topic/comment/reply_temps",params:{reply:""}}}},methods:{cancel:function(){this.$emit("cancel")},ok:function(){if(this.path&&this.user&&(this.commentParam.commentId||this.commentParam.share_id||this.commentParam.topic_id)&&this.commentContent){var e={api:{path:this.path}},t={share_id:this.commentParam.share_id?this.commentParam.share_id:0,uid:this.user,content:this.commentContent,reply_id:this.commentParam.commentId?this.commentParam.commentId:0};this.commentParam.topic_id&&(t.topic_id=this.commentParam.topic_id),this.imageComment&&this.image&&(t.image=this.image),this.$Util.api.post(e,t,this).then(function(e){this.responseData.error_code=e.error_code,this.responseData.error_description=e.error_description,0==e.error_code?(this.$Modal.success({title:"评论成功！"}),this.clearUserDataAfterCloseModal()):this.$Notice.warning({title:"回复评论失败！",desc:e.error_description}),this.$emit("on-response",this.responseData)},function(){this.$Notice.warning({title:"回复评论失败！",desc:""})})}else if(!this.user){var i="回复失败，你忘了选择回复账号";this.$Message.error(i),this.responseData={error_code:-1,error_description:i},this.$emit("on-response",this.responseData)}this.$emit("confirm")},clearUserDataAfterCloseModal:function(){this.commentContent=""},showExpressionImg:function(){this.showExpression=!this.showExpression},appendToCommentContent:function(e){this.commentContent=this.commentContent+e,this.nextPage=!1,this.showExpression=!1},showExpressionNextPage:function(){this.nextPage=!this.nextPage},deleteQuickReply:function(e){this.removeQuickReplyApi.params.reply=e;var t={api:this.removeQuickReplyApi,reload:!1};this.$Util.api.delete(t,this).then(function(t){if(t.data){var i=this.quickReplyList.indexOf(e);this.quickReplyList.splice(i,1),this.$Message.info("删除成功")}else this.$Message.warning("唷，删除失败")},function(){this.$Message.warning("唷，删除失败")})},addNewQuickReply:function(){var e={api:this.addQuickReplyApi};this.$Util.api.post(e,this.addQuickReplyApi.params,this).then(function(e){e.data?(this.quickReplyList.push(this.addQuickReplyApi.params.reply),this.addQuickReplyBox=!1,this.addQuickReplyApi.params.reply="",this.$Message.info("添加成功")):this.$Message.warning("唷，新增失败")},function(){})},paddingData:function(){var e={api:this.quickReplyListApi};this.$Util.api.get(e,this).then(function(e){this.quickReplyList=e.data},function(){})}},created:function(){this.$nextTick(function(){this.paddingData()})}}},GYYP:function(e,t,i){"use strict";function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0});var o=i("quZV"),a=i.n(o),s=i("mnw/"),l=i.n(s);t.default={components:{CommentContentInfo:a.a,MReplyModal:l.a},data:function(){var e=this;return{imageComment:!0,commentParam:{commentId:"",topic_id:this.$route.params.topicId},showDeleteReasonBox:!1,removeApi:{path:"/boss/community/topic/topic/topics",params:{ids:"",reason:""}},reasonList:[{value:"广告内容",label:"广告内容"},{value:"发布微信号等其他账号导流",label:"发布微信号等其他账号导流"},{value:"黄反信息",label:"黄反信息"},{value:"不符合当前版规",label:"不符合当前版规"},{value:"其他原因",label:"其他原因"},{value:"不发送小秘书",label:"不发送小秘书"}],showReplyModal:!1,props:{id:{type:String,default:""}},comments:[],replyApi:{path:"/boss/community/topic/comment/reply",params:{}},api:{path:"/boss/community/topic/comment/list",params:{base_fields:"list[].comment_id,list[].create_time,list[].content,list[].is_louzhu,list[].floor,list[].user.uid,list[].user.nickname,list[].reply_comment.user.nickname,list[].reply_comment.user.uid,list[].images[].m(640|webp),list[].images[].w(640|webp|1),list[].sub_comments[].reply_comment.user.nickname,list[].sub_comments[].comment_id,list[].sub_comments[].reply_comment.user.uid,list[].sub_comments[].create_time,list[].sub_comments[].content,list[].sub_comments[].images[].m(640|webp),list[].sub_comments[].images[].w(640|webp|1),list[].sub_comments[].user.nickname,list[].sub_comments[].user.uid",topicId:this.$route.params.topicId}},pageInfoApi:{path:"/boss/community/topic/comment/list-page-info",params:{topicId:this.$route.params.topicId}},columns:[{width:"20%",title:"楼层",key:"floor"},{title:"评论内容",render:function(t,i){var o;return t(a.a,{props:{value:i.row},on:(o={},n(o,"show-modal",function(t){e.showReplyModal=!0,e.commentParam.commentId=t}),n(o,"show-delete",function(t){e.showDeleteReasonBox=!0,e.removeApi.params.ids=t}),o)})}}]}},methods:{remove:function(){bus.$emit("on-loading");var e=this;vm.$Util.api.delete({api:{path:"/boss/community/topic/comment/delete",params:{ids:this.removeApi.params.ids,reason:this.removeApi.params.reason}},reload:!1},vm).then(function(){e.$Message.success("删除成功"),setTimeout(function(){location.reload()},1e3)},function(e){alert(e)})},reply:function(){this.showReplyModal=!0,this.commentParam.commentId="0"},closeReply:function(){this.showReplyModal=!1},replyResponseHandle:function(e){if(e&&0===e.error_code)setTimeout(function(){location.reload()},1e3);else{e&&e.error_description&&e.error_description}},back:function(){window.close()},responseHandle:function(e){var t=this;return null!==e.data&&e.data.map(function(e){var i={id:e.comment_id,content:e.content,createTime:e.create_time,replyComment:e.reply_comment,subComments:e.sub_comments,image:e.images};return t.comments.push(i),t.comments}),e}}}},IW3u:function(e,t,i){var n=i("b4U5");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("2b914227",n,!0)},L3WW:function(e,t,i){var n=i("VU/8")(i("GYYP"),i("tWDV"),null,null);e.exports=n.exports},L5X0:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Modal",{attrs:{title:"回复","mask-closable":!1},on:{"on-ok":e.ok,"on-cancel":e.cancel},model:{value:e.isVisible,callback:function(t){e.isVisible=t},expression:"isVisible"}},[i("div",{staticClass:"mrm-modal-block"},[i("div",{staticClass:"mrm-modal-top"},[i("p",{staticClass:"mrm-modal-top-center"},[e._v("账号")])]),e._v(" "),i("RadioGroup",{staticClass:"mrm-modal-top",model:{value:e.account,callback:function(t){e.account=t},expression:"account"}},[i("div",{staticClass:"mrm-modal-top-account"},[i("div",[i("MUserPicking",{attrs:{width:300,containRandom:!0},model:{value:e.user,callback:function(t){e.user=t},expression:"user"}})],1)])])],1),e._v(" "),i("div",{staticClass:"mrm-modal-block"},[i("div",{staticClass:"mrm-modal-top"},[i("p",{staticClass:"mrm-modal-top-center"},[e._v("评论")])]),e._v(" "),i("div",{staticClass:"mrm-modal-comment-content"},[i("Input",{attrs:{size:"large ",type:"textarea",rows:4,placeholder:"请输入评论内容..."},model:{value:e.commentContent,callback:function(t){e.commentContent=t},expression:"commentContent"}})],1),e._v(" "),i("div",{staticClass:"mrm-modal-quick-reply"},[e._l(e.quickReplyList,function(t,n){return i("Tag",{key:t,attrs:{type:"border",closable:"",color:"blue",closable:""},on:{"on-close":function(i){e.deleteQuickReply(t)}},nativeOn:{click:function(i){e.appendToCommentContent(t)}}},[e._v("\n                    "+e._s(t.substring(0,25))+"\n                ")])}),e._v(" "),i("Button",{attrs:{icon:"ios-plus-empty",size:"small",type:"border"},on:{click:function(t){e.addQuickReplyBox=!0}}},[e._v("快捷回复\n                ")])],2),e._v(" "),i("div",{staticClass:"mrm-modal-expression"},[i("div",{staticClass:"mrm-modal-expression-span"},[i("Button",{attrs:{shape:"circle",icon:"happy-outline"},on:{click:e.showExpressionImg}})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showExpression,expression:"showExpression"}],staticClass:"mrm-modal-expression-img"},[i("div",{attrs:{id:"emojiContainer"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.nextPage,expression:"!nextPage"}]},[e._l(e.expressionImgs[0],function(t,n){return i("img",{attrs:{src:e.emoticonsPath+t.fileName,title:t.title},on:{click:function(i){e.appendToCommentContent("["+t.title+"]")}}})}),e._v(" "),i("Icon",{staticStyle:{float:"right",margin:"10px 20px 0 0",cursor:"pointer"},attrs:{type:"toggle",size:"35",title:"切换表情"},nativeOn:{click:function(t){return e.showExpressionNextPage(t)}}})],2),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.nextPage,expression:"nextPage"}]},[e._l(e.expressionImgs[1],function(t,n){return i("img",{attrs:{src:e.emoticonsPath+t.fileName,title:t.title},on:{click:function(i){e.appendToCommentContent("["+t.title+"]")}}})}),e._v(" "),i("Icon",{staticStyle:{float:"right",margin:"10px 20px 0 0",cursor:"pointer"},attrs:{type:"toggle-filled",size:"35",title:"切换表情"},nativeOn:{click:function(t){return e.showExpressionNextPage(t)}}})],2)])])]),e._v(" "),e.imageComment?i("div",{staticClass:"mrm-modal-comment-img"},[i("m-upload-image",{model:{value:e.image,callback:function(t){e.image=t},expression:"image"}})],1):e._e()])]),e._v(" "),i("Modal",{attrs:{width:"360"},model:{value:e.addQuickReplyBox,callback:function(t){e.addQuickReplyBox=t},expression:"addQuickReplyBox"}},[i("p",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[i("span",[e._v("新增快捷回复")])]),e._v(" "),i("Input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:10}},model:{value:e.addQuickReplyApi.params.reply,callback:function(t){e.$set(e.addQuickReplyApi.params,"reply",t)},expression:"addQuickReplyApi.params.reply"}}),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:e.addNewQuickReply}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]}},PZ8o:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",[i("i-button",{staticStyle:{color:"#39f","text-decoration":"underline"},attrs:{type:"text"},on:{click:function(t){e.see(e.info.user.uid)}}},[e._v("["+e._s(e.info.user.uid)+"]\n        ")]),e._v(" "),i("span",[e._v(e._s(e.info.user.nickname))])],1),e._v(" "),i("p",[e._v(e._s(e.info.create_time))]),e._v(" "),i("p",[e._v(e._s(e.info.content))]),e._v(" "),e._l(e.info.images,function(t){return e.info.images?i("div",[i("img",{attrs:{src:t.m.url,width:"80",height:"80"}})]):e._e()}),e._v(" "),i("div",[i("i-button",{staticStyle:{color:"#39f","text-decoration":"underline"},attrs:{type:"text"},on:{click:function(t){e.showModal(e.info.comment_id)}}},[e._v("回复\n        ")]),e._v(" "),i("i-button",{staticStyle:{color:"red","text-decoration":"underline"},attrs:{type:"text"},on:{click:function(t){e.remove(e.info.comment_id)}}},[e._v("删除\n        ")])],1),e._v(" "),e.info.sub_comments?i("Collapse",{model:{value:e.info.sub_comments,callback:function(t){e.$set(e.info,"sub_comments",t)},expression:"info.sub_comments"}},[i("Panel",[e._v("\n            评论回复区\n            "),e._l(e.info.sub_comments,function(t){return i("div",{attrs:{slot:"content"},slot:"content",model:{value:e.info.sub_comments,callback:function(t){e.$set(e.info,"sub_comments",t)},expression:"info.sub_comments"}},[i("div",[i("i-button",{staticStyle:{color:"#39f","text-decoration":"underline"},attrs:{type:"text"},on:{click:function(i){e.see(t.user.uid)}}},[e._v("["+e._s(t.user.uid)+"]\n                    ")]),e._v(" "),i("span",[e._v(e._s(t.user.nickname)+" 回复")]),e._v(" "),i("i-button",{staticStyle:{color:"#39f","text-decoration":"underline"},attrs:{type:"text"},on:{click:function(i){e.see(t.reply_comment.user.uid)}}},[e._v("["+e._s(t.reply_comment.user.uid)+"]\n                    ")]),e._v(" "),i("span",[e._v(e._s(t.reply_comment.user.nickname))])],1),e._v(" "),i("p",[e._v(e._s(t.create_time))]),e._v(" "),i("p",[e._v(e._s(t.content))]),e._v(" "),e._l(t.images,function(n){return t.images?i("div",[i("img",{attrs:{src:n.m.url,width:"80",height:"80"}})]):e._e()}),e._v(" "),i("div",[i("i-button",{staticStyle:{color:"#39f","text-decoration":"underline"},attrs:{type:"text"},on:{click:function(i){e.showModal(t.comment_id)}}},[e._v("回复\n                    ")]),e._v(" "),i("i-button",{staticStyle:{color:"red","text-decoration":"underline"},attrs:{type:"text"},on:{click:function(i){e.remove(t.comment_id)}}},[e._v("删除\n                    ")])],1)],2)})],2)],1):e._e()],2)},staticRenderFns:[]}},"V/dC":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("mnw/"),o=i.n(n);t.default={name:"CommentContentInfo",components:{MReplyModal:o.a},props:{value:{type:Object,default:function(){return{}}},initVisible:{type:Boolean,default:!1}},data:function(){return{showReplyModal:!1}},computed:{info:function(){return this.value}},methods:{showModal:function(e){this.showReplyModal=!0,this.$emit("show-modal",e)},see:function(e){window.open("/admin.php?uid="+e+"&m=Admin&c=User&c=User&a=index")},reply:function(){vm.$Util.api.post({api:{path:"/boss/community/topic/comment/reply",params:{id:this.value.comment_id}}},vm).then(function(){location.reload()},function(e){alert(e)})},remove:function(e){this.showDeleteReasonBox=!0,this.$emit("show-delete",e)},closeReply:function(){this.showReplyModal=!1}},created:function(){this.value.create_time=vm.$Util.dateFormat(this.value.create_time,"MM-dd hh:mm"),this.value.create_time=this.value.create_time.replace("-","月").replace(" ","日 "),this.value.sub_comments&&this.value.sub_comments.length>0&&this.value.sub_comments.map(function(e){e.create_time=vm.$Util.dateFormat(e.create_time,"MM-dd hh:mm"),e.create_time=e.create_time.replace("-","月").replace(" ","日 ")})}}},b4U5:function(e,t,i){t=e.exports=i(0)(),t.push([e.i,".mrm-modal-block[data-v-48e2c5b2],.mrm-modal-top[data-v-48e2c5b2]{float:left}.mrm-modal-top-left[data-v-48e2c5b2]{width:100px}.mrm-modal-top-center[data-v-48e2c5b2]{width:100px;text-align:center}.mrm-modal-top-account[data-v-48e2c5b2]{padding-bottom:50px}.mrm-modal-top-account div[data-v-48e2c5b2]{float:left}.mrm-modal-comment-content[data-v-48e2c5b2]{width:300px;float:left}.mrm-modal-quick-reply[data-v-48e2c5b2]{padding-left:100px;width:100%;float:left}.mrm-modal-comment-img[data-v-48e2c5b2]{float:right;margin-top:20px;padding-left:100px;width:100%}#emojiContainer div img[data-v-48e2c5b2]{width:35px;cursor:pointer;margin:3px}.mrm-modal-expression[data-v-48e2c5b2]{float:left;width:100%;position:relative}.mrm-modal-expression-span[data-v-48e2c5b2]{padding:20px 0 0 90px}.mrm-modal-expression-img[data-v-48e2c5b2]{position:absolute;border:1px solid #eee;background-color:#fff;top:-120px;left:100px;padding:2px;border-radius:10px}",""])},"mnw/":function(e,t,i){i("IW3u");var n=i("VU/8")(i("DHNN"),i("L5X0"),"data-v-48e2c5b2",null);e.exports=n.exports},quZV:function(e,t,i){var n=i("VU/8")(i("V/dC"),i("PZ8o"),null,null);e.exports=n.exports},tWDV:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("m-page-list",{attrs:{path:e.api.path,params:e.api.params,columns:e.columns,methods:e.methods,"response-handle":e.responseHandle,"page-info-path":e.pageInfoApi.path,"page-info-params":e.pageInfoApi.params}},[i("Card",[i("div",{staticStyle:{"padding-top":"20px"}},[i("i-button",{staticStyle:{color:"#39f","text-decoration":"underline"},attrs:{type:"text"}},[e._v("帖子ID："+e._s(this.$route.params.topicId)+"\n            ")]),e._v(" "),i("div",[i("Button",{staticStyle:{color:"#39f"},attrs:{type:"ghost"},on:{click:e.reply}},[e._v("\n                    +回复帖子\n                ")]),e._v(" "),i("Button",{staticStyle:{"margin-left":"8px",color:"#39f"},attrs:{type:"ghost"},on:{click:e.back}},[e._v("\n                    返回\n                ")])],1)],1)]),e._v(" "),i("m-reply-modal",{attrs:{path:e.replyApi.path,title:e.回复评论,commentParam:e.commentParam,isVisible:e.showReplyModal,imageComment:e.imageComment},on:{cancel:e.closeReply,confirm:e.closeReply,"on-response":e.replyResponseHandle}}),e._v(" "),i("Modal",{attrs:{width:"360"},model:{value:e.showDeleteReasonBox,callback:function(t){e.showDeleteReasonBox=t},expression:"showDeleteReasonBox"}},[i("p",{staticStyle:{color:"#f60"},attrs:{slot:"header"},slot:"header"},[i("Icon",{attrs:{type:"information-circled"}}),e._v(" "),i("span",[e._v("删除原因")])],1),e._v(" "),i("Select",{staticStyle:{width:"200px"},model:{value:e.removeApi.params.reason,callback:function(t){e.$set(e.removeApi.params,"reason",t)},expression:"removeApi.params.reason"}},e._l(e.reasonList,function(t){return i("Option",{key:t,attrs:{value:t.value}},[e._v(e._s(t.label))])})),e._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"info",loading:e.modal_loading},on:{click:e.remove}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]}}});