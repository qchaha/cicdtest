webpackJsonp([181],{"7d5W":function(e,t,o){o("DgIx");var i=o("VU/8")(o("sRms"),o("Yax4"),"data-v-b32a523e",null);e.exports=i.exports},DgIx:function(e,t,o){var i=o("Tk/k");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);o("rjj0")("7a0f4b36",i,!0)},"Tk/k":function(e,t,o){t=e.exports=o(0)(),t.push([e.i,".info .unit[data-v-b32a523e]{display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start;margin-bottom:15px}.info span[data-v-b32a523e]{display:block;margin-right:10px;font-size:15px}.info img[data-v-b32a523e]{display:block;max-width:260px}",""])},Yax4:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("m-page",[o("div",{staticClass:"info"},[o("div",{staticClass:"unit"},[o("span",{staticClass:"title"},[e._v("专栏名称")]),e._v(" "),o("span",[e._v(e._s(e.infoData.name))])]),e._v(" "),o("div",{staticClass:"unit"},[o("span",{staticClass:"title"},[e._v("专栏描述")]),e._v(" "),o("span",[e._v(e._s(e.infoData.description))])]),e._v(" "),o("div",{staticClass:"unit"},[o("span",{staticClass:"title"},[e._v("封面图")]),e._v(" "),o("img",{attrs:{src:e.infoData.cover}})]),e._v(" "),o("div",{staticClass:"unit"},[o("span",[e._v("包含教程"+e._s(e.infoData.normal_course_count)+"个，线上课"+e._s(e.infoData.online_course_count)+"个")])])]),e._v(" "),o("div",{staticClass:"handle",staticStyle:{"margin-bottom":"30px"}},[o("Input",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{placeholder:"输入教程id"},model:{value:e.normal_course_ids,callback:function(t){e.normal_course_ids=t},expression:"normal_course_ids"}}),e._v(" "),o("Input",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{placeholder:"输入线上课id"},model:{value:e.online_course_ids,callback:function(t){e.online_course_ids=t},expression:"online_course_ids"}}),e._v(" "),o("Button",{staticStyle:{width:"120px"},attrs:{type:"primary"},on:{click:e.addColumn}},[e._v("加入该专栏")])],1),e._v(" "),o("m-page-list",{attrs:{path:e.api.path,params:e.api.params,columns:e.columns,"sort-key":"ordering","sort-index":6,"sort-path":e.sortInfoApi.path,sortable:e.sortable,"page-info-path":e.pageInfoApi.path,"page-info-params":e.pageInfoApi.params,"response-handle":e.responseHandle},on:{"on-page-info-success":e.handleListPageInfoSuccess}})],1)},staticRenderFns:[]}},sRms:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={props:{type:"text",size:"small"},style:{display:"inline-block",marginRight:"8px",color:"#39f",padding:0}},s={props:{type:"text",size:"small"},style:{display:"block",color:"#39f",padding:0}},n={getDetail:function(e){return{api:{path:"/boss/education/courses/courses/columns/"+e,params:{fields:'{id,name,description,normal_course_ids,online_course_ids,course_count,cover{s(w:320,h:320,format:"webp"){url,width,height}}}}'}}}},addColumn:function(e){return{api:{path:"/boss/education/courses/columns/"+e+"/courses"}}}};t.default={name:"column-detail",data:function(){var e=this;return{id:this.$route.params.id,infoData:{name:"",description:"",cover:"",course_count:0,normal_course_count:0,online_course_count:0},normal_course_ids:"",online_course_ids:"",sortable:!0,searchTypeSource:{},searchCondition:{course_type:"",title:"",course_id:""},sortInfoApi:{path:"/boss/education/courses/columns/"+this.$route.params.id+"/courses/sort"},api:{path:"/boss/education/courses/course-columns/find-list",params:{column_id:this.$route.params.id,fields:"{id,online_course{id,title,teacher{user{user_name}}},normal_course{group{group_id,name},author{user_name},course_id,title},ordering,course_type}",limit:24,offset:0}},pageInfoApi:{path:"/boss/education/courses/columns/"+this.$route.params.id+"/courses/list-page-info",params:{}},columns:[{title:"课程id",render:function(e,t){var o=t.row;return e("div",o.online_course?o.online_course.id:o.normal_course.course_id)}},{title:"课程名称",render:function(e,t){var o=t.row,i="";switch(o.course_type){case 1:i=o.normal_course.title;break;case 2:i=o.online_course.title}return e("div",i)}},{title:"类型",render:function(e,t){return e("div",2===t.row.course_type?"直播课":"教程")}},{title:"小组",render:function(e,t){return e("div",t.row.normal_course.group.name)}},{title:"作者",render:function(e,t){var o=t.row;return e("div",o.online_course?o.online_course.teacher.user.user_name:o.normal_course.author.user_name)}},{title:"操作",render:function(t,o){var n=[],a=o.row,r=a.id;return n[0]=t("Button",Object.assign(i,{on:{click:function(){e.toCheck(a)}}}),"查看"),n[1]=t("Button",Object.assign(i,{on:{click:function(){e.toEdit(a)}}}),"编辑"),n[2]=t("Button",Object.assign(s,{on:{click:function(){e.confirmDelete(r)}}}),"从本专栏移除"),t("div",n)}}],responseHandle:function(e){null===e.data&&(e.data=[]);for(var t in e.data){e.data[t].price<=0?e.data[t].price="免费":1==e.data[t].course_type&&(e.data[t].price=e.data[t].price+"钻")}return e}}},methods:{handleListPageInfoSuccess:function(e){},searchConditionHandle:function(e){var t=0===e.course_type.length&&0===e.title.length&&0===e.course_id.length;return this.sortable=t,e},getBaseInfo:function(){var e=this;this.$Util.api.get(n.getDetail(this.$route.params.id),this).then(function(t){e.infoData=t.data,e.infoData.cover=void 0!==t.data.cover.s.url?t.data.cover.s.url:"";for(var o=t.data.online_course_ids.split(","),i=t.data.normal_course_ids.split(","),s=0,n=0,a=0;a<o.length;a++)""!==o[a]&&n++;for(var r=0;r<i.length;r++)""!==i[r]&&s++;e.infoData.normal_course_count=s,e.infoData.online_course_count=n})},addColumn:function(){var e=this,t={normal_course_ids:this.normal_course_ids,online_course_ids:this.online_course_ids};this.$Util.api.post(n.addColumn(this.$route.params.id),t,this).then(function(t){if(0===t.error_code)return e.$Message.info("添加成功"),e.normal_course_ids="",e.online_course_ids="",void window.location.reload();e.$Message.error(t.error_description)})},toCheck:function(e){var t=1===e.course_type?e.normal_course.course_id:e.online_course.id;if(1===e.course_type){var o="http://m.meijiabang.cn/#!course/"+t;window.open(o,"","width=375,height=667")}else{var i="/backend/#/education/livelesson/lesson/detail/"+t;window.location.href=i}},toEdit:function(e){var t=1===e.course_type?e.normal_course.course_id:e.online_course.id,o="";o=1===e.course_type?"/admin.php?m=Admin&c=Course&a=edit&course_id="+t:"/backend/#/education/livelesson/lesson/edit/"+t,window.location.href=o},confirmDelete:function(e){var t=this;this.$Modal.confirm({title:"确定移除该课程？",onOk:function(){t.toDelete(e)}})},toDelete:function(e){var t=this,o={path:"/boss/education/courses/course-columns/"+e};this.$Util.api.delete({api:o},this).then(function(e){if(0===e.error_code)return void window.location.reload();t.$Message.error(e.error_description)})}},mounted:function(){this.getBaseInfo()}}}});