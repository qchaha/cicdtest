webpackJsonp([62],{Awyp:function(e,t,a){a("lGaE");var i=a("VU/8")(a("saET"),a("bqnX"),"data-v-dd0285e4",null);e.exports=i.exports},K8bI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Awyp"),r=a.n(i);t.default={name:"app",components:{MResumeForm:r.a},data:function(){return{id:this.$route.params.id}}}},NcyF:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("m-page-edit",[a("m-resume-form",{attrs:{usage:"edit",id:e.id}})],1)},staticRenderFns:[]}},bqnX:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"padding-top":"20px"}},[a("Form",{attrs:{model:e.formItem,"label-width":80}},["edit"===e.usage?a("m-card",[a("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("运营区")]),e._v(" "),a("div",{staticStyle:{background:"#eee",width:"500px",padding:"10px"}},[a("ul",[a("li",[e._v("简历ID："+e._s(e.formItem.id))]),e._v(" "),a("li",[e._v("用户id & 用户昵称："+e._s(e.formItem.creator.uid)+" & "+e._s(e.formItem.creator.nickname))]),e._v(" "),a("li",[e._v("资料完成度："+e._s(e.formItem.completion_percent)+"%")])])]),e._v(" "),a("Form-item",{attrs:{label:"置顶时间"}},[a("Date-picker",{staticStyle:{width:"300px"},attrs:{type:"daterange",placeholder:"选择日期",options:e.options,value:e.formItem.recommend_time},on:{"on-change":e.getRecommendTime}})],1)],1):e._e(),e._v(" "),a("m-card",[a("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("必填信息")]),e._v(" "),a("Form-item",{attrs:{label:"姓名"}},[a("Input",{staticStyle:{width:"300px"},attrs:{maxlength:30,placeholder:"姓名"},model:{value:e.formItem.full_name,callback:function(t){e.$set(e.formItem,"full_name",t)},expression:"formItem.full_name"}})],1),e._v(" "),a("Form-item",{attrs:{label:"职位"}},[a("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.formItem.expected_job_name,callback:function(t){e.$set(e.formItem,"expected_job_name",t)},expression:"formItem.expected_job_name"}},e._l(e.names,function(t){return a("Option",{attrs:{value:t}},[e._v(e._s(t))])}))],1),e._v(" "),a("Form-item",{attrs:{label:"期望薪资"}},[a("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.formItem.expected_job_salary,callback:function(t){e.$set(e.formItem,"expected_job_salary",t)},expression:"formItem.expected_job_salary"}},e._l(e.salaries,function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])}))],1),e._v(" "),a("Form-item",{attrs:{label:"期望地区"}},[a("Cascader",{staticStyle:{width:"300px"},attrs:{data:e.regions,trigger:"hover",clearable:""},model:{value:e.formItem.expected_job_location,callback:function(t){e.$set(e.formItem,"expected_job_location",t)},expression:"formItem.expected_job_location"}})],1),e._v(" "),a("Form-item",{attrs:{label:"工作年限"}},[a("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.formItem.career_length,callback:function(t){e.$set(e.formItem,"career_length",t)},expression:"formItem.career_length"}},e._l(e.career_lengths,function(t){return a("Option",{attrs:{value:t}},[e._v(e._s(t))])}))],1),e._v(" "),a("Form-item",{attrs:{label:"全职/兼职"}},[a("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.formItem.expected_job_property,callback:function(t){e.$set(e.formItem,"expected_job_property",t)},expression:"formItem.expected_job_property"}},e._l(e.properties,function(t){return a("Option",{attrs:{value:t}},[e._v(e._s(t))])}))],1),e._v(" "),a("Form-item",{attrs:{label:"求职状态"}},[a("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{"on-change":e.getStatus},model:{value:e.formItem.status,callback:function(t){e.$set(e.formItem,"status",t)},expression:"formItem.status"}},e._l(e.modes,function(t){return a("Option",{attrs:{value:t}},[e._v(e._s(t))])}))],1),e._v(" "),"add"===e.usage?a("Form-item",{attrs:{label:"用户id"}},[a("Input-number",{staticStyle:{width:"200px"},attrs:{placeholder:"用户ID"},model:{value:e.formItem.uid,callback:function(t){e.$set(e.formItem,"uid",t)},expression:"formItem.uid"}})],1):e._e(),e._v(" "),a("Form-item",{attrs:{label:"自拍照"}},[a("m-upload-image",{attrs:{"default-images":e.formItem.defaultAvatar},on:{"on-success":e.getAvatar}})],1)],1),e._v(" "),a("m-card",[a("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("其他信息")]),e._v(" "),a("Form-item",{attrs:{label:"擅长"}},[a("Checkbox-group",{model:{value:e.formItem.skills,callback:function(t){e.$set(e.formItem,"skills",t)},expression:"formItem.skills"}},e._l(e.skill,function(e){return a("Checkbox",{attrs:{label:e}})}))],1),e._v(" "),a("Form-item",{attrs:{label:"电话"}},[a("Input",{staticStyle:{width:"300px"},attrs:{maxlength:30,placeholder:"电话"},model:{value:e.formItem.phone,callback:function(t){e.$set(e.formItem,"phone",t)},expression:"formItem.phone"}})],1),e._v(" "),a("Form-item",{attrs:{label:"微信"}},[a("Input",{staticStyle:{width:"300px"},attrs:{maxlength:30,placeholder:"微信"},model:{value:e.formItem.wechat_number,callback:function(t){e.$set(e.formItem,"wechat_number",t)},expression:"formItem.wechat_number"}})],1),e._v(" "),a("Form-item",{attrs:{label:"性别"}},[a("i-switch",{model:{value:e.formItem.is_male,callback:function(t){e.$set(e.formItem,"is_male",t)},expression:"formItem.is_male"}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("男")]),e._v(" "),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("女")])])],1),e._v(" "),a("Form-item",{attrs:{label:"年龄"}},[a("Input-number",{staticStyle:{width:"200px"},attrs:{max:150,min:0},model:{value:e.formItem.age,callback:function(t){e.$set(e.formItem,"age",t)},expression:"formItem.age"}})],1),e._v(" "),a("Form-item",{attrs:{label:"作品"}},[a("m-upload-image",{attrs:{multiple:"","default-images":e.formItem.defaultOpusImages},on:{"on-success":e.getOpusImages}})],1),e._v(" "),a("Form-item",{attrs:{label:"特长介绍"}},[a("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"特长介绍"},model:{value:e.formItem.specialty,callback:function(t){e.$set(e.formItem,"specialty",t)},expression:"formItem.specialty"}})],1)],1),e._v(" "),a("m-card",[a("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("工作经验")]),e._v(" "),e._l(e.formItem.job_experiences,function(t,i){return a("Form-item",{attrs:{label:"工作经验"}},[a("Row",[a("div",{staticClass:"name"},[a("Input",{staticStyle:{width:"300px"},attrs:{maxlength:30,placeholder:"公司名称"},model:{value:t.company_name,callback:function(a){e.$set(t,"company_name",a)},expression:"item.company_name"}})],1),e._v(" "),a("div",{staticClass:"name"},[a("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:t.job_name,callback:function(a){e.$set(t,"job_name",a)},expression:"item.job_name"}},e._l(e.names,function(t){return a("Option",{attrs:{value:t}},[e._v(e._s(t))])}))],1),e._v(" "),a("div",{staticClass:"time"},[a("Date-picker",{attrs:{type:"month",placeholder:"选择开始日期"},model:{value:t.start_time,callback:function(a){e.$set(t,"start_time",a)},expression:"item.start_time"}})],1),e._v(" "),a("div",{staticClass:"time"},[a("Date-picker",{attrs:{type:"month",placeholder:"选择结束日期"},model:{value:t.end_time,callback:function(a){e.$set(t,"end_time",a)},expression:"item.end_time"}})],1),e._v(" "),a("div",{staticClass:"delete"},[a("Button",{staticStyle:{"background-color":"#fff"},attrs:{type:"ghost"},on:{click:function(t){e.handleDelete(i)}}},[e._v("删除")])],1)])],1)}),e._v(" "),a("Form-item",[a("Row",{attrs:{span:"8"}},[a("i-col",{attrs:{span:"8"}},[a("Button",{staticStyle:{"background-color":"#fff"},attrs:{type:"ghost",long:"",icon:"plus-round"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1)],2),e._v(" "),a("m-card",[a("Affix",{attrs:{"offset-bottom":0}},[a("Form-item",[a("i-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submit(t)}}},[e._v("提交")]),e._v(" "),"edit"===e.usage?a("i-button",{attrs:{type:"ghost"},nativeOn:{click:function(t){return e.remove(t)}}},[e._v("删除")]):e._e()],1)],1)],1)],1)],1)},staticRenderFns:[]}},lGaE:function(e,t,a){var i=a("pwYM");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("6f690a08",i,!0)},pwYM:function(e,t,a){t=e.exports=a(0)(),t.push([e.i,".time[data-v-dd0285e4]{display:inline-block;width:200px}.name[data-v-dd0285e4],.time[data-v-dd0285e4]{margin:10px 0}.delete[data-v-dd0285e4]{display:inline-block}[class*=span][data-v-dd0285e4]{margin-left:0}",""])},saET:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("h45B"),r=a.n(i),s={create:{api:{path:"/boss/education/recruitment/resume/create"}},update:{api:{path:"/boss/education/recruitment/resume/update"}},remove:{api:{path:"/boss/education/recruitment/resume/delete",params:{id:0}}},find:{api:{path:"/boss/education/recruitment/resume/find",params:{fields:"{id,recommend_start_time,recommend_end_time,uid,full_name,is_male,status,phone,wechat_number,career_length,update_time,skills,completion_percent,age,specialty,avatar{s(w:80){url,origin}},creator{uid,nickname},opus_images{s(w:80){url,origin}},tags{name},expected_job{name,salary,property,location{province_id,city_id,district_id}},job_experiences{job_experience_id,company_name,job_name,start_time,end_time}}",id:0}},responseHandle:function(e){if(e.data.expected_job_location=[e.data.expected_job.location.province_id+"",e.data.expected_job.location.city_id+"",e.data.expected_job.location.district_id+""],0!==e.data.job_experiences.length)for(var t in e.data.job_experiences){var a=e.data.job_experiences[t],i=new Date;i.setTime(1e3*a.start_time),e.data.job_experiences[t].start_time=i;var r=new Date;-1===a.end_time?r="至今":r.setTime(1e3*a.end_time),e.data.job_experiences[t].end_time=r}return e}},resource:{api:{path:"/boss/education/recruitment/resume/add-page-info",params:{}},responseHandle:function(e){var t=[];for(var a in e.data.form.regions){var i=e.data.form.regions[a],r={value:i.area_code,label:i.name,children:[]};for(var s in i.cities){var o=i.cities[s],n={value:o.area_code,label:o.name,children:[]};for(var m in o.areas){var l=o.areas[m],c={value:l.area_code,label:l.name};n.children.push(c)}r.children.push(n)}t.push(r)}return e.regions=t,e.options=e.data.form.options,e}}};t.default={components:{MCard:r.a},name:"MResumeForm",props:{id:{type:String,name:""},usage:{type:String,name:"edit"}},data:function(){return{formItem:{creator:[],region:[],id:0,uid:0,recommend_time:[],recommend_start_time:0,recommend_end_time:0,full_name:"",expected_job:[],expected_job_name:"",expected_job_salary:"",expected_job_location:[],career_length:"",expected_job_property:"",status:"",mode:0,avatar:[],expected_province_id:0,expected_city_id:0,expected_district_id:0,skills:[],phone:"",wechat_number:"",is_male:!1,age:0,opus_images:[],specialty:"",job_experiences:[]},regions:[],names:[],career_lengths:[],properties:[],skill:[],gender:[],modes:[],salaries:[],limit:9,options:{disabledDate:function(e){return e&&e.valueOf()<Date.now()-864e5}}}},methods:{handleDelete:function(e){this.formItem.job_experiences.splice(e,1)},handleAdd:function(){this.formItem.job_experiences.push({job_experience_id:0,company_name:"",job_name:"",start_time:0,end_time:0})},getAvatar:function(e){this.formItem.avatar=e},getOpusImages:function(e){this.formItem.opus_images=e},getRegion:function(e){this.formItem.expected_province_id=e[0],this.formItem.expected_city_id=e[1],this.formItem.expected_district_id=e[2]},getRecommendTime:function(e){var t=new Date(e[0]),a=new Date(e[1]);this.formItem.recommend_start_time=t.getTime()/1e3-28800,this.formItem.recommend_end_time=a.getTime()/1e3-28800},getStatus:function(e){var t=0;switch(e){case"在职暂不考虑":default:t=0;break;case"在职考虑机会":t=1;break;case"离职随时入职":t=2;break;case"离职一周内入职":t=3;break;case"离职月内入职":t=4}this.formItem.mode=t},back:function(){location.hash="/education/recruitment/resume/list/0"},remove:function(){if("edit"===this.usage){var e=this.id;if(!parseInt(e))return alert("职位id格式有误"),!1;e=parseInt(e),this.formItem.id=e,s.remove.api.params.id=e,confirm("确认删除?")&&vm.$Util.api.delete(s.remove).then(this.back())}},submit:function(){if(this.validateFormData()){var e=this.getRequestParams();this.submitRequest(e)}},validateFormData:function(){return 0===this.formItem.uid&&"add"===this.usage?(this.$Message.warning("用户ID不能为空"),!1):0===this.formItem.full_name.length?(this.$Message.warning("姓名不能为空"),!1):0===this.formItem.expected_job_name.length?(this.$Message.warning("职位不能为空"),!1):0===this.formItem.expected_job_salary.length?(this.$Message.warning("期望薪资不能为空"),!1):0===this.formItem.expected_job_location.length?(this.$Message.warning("期望地区不能为空"),!1):0===this.formItem.career_length.length?(this.$Message.warning("工作年限不能为空"),!1):0===this.formItem.expected_job_property.length?(this.$Message.warning("全职/兼职不能为空"),!1):0===this.formItem.status.length?(this.$Message.warning("求职状态不能为空"),!1):0!==this.formItem.avatar.length||(this.$Message.warning("必须上传自拍照"),!1)},getRequestParams:function(){var e={name:this.formItem.full_name,uid:this.formItem.uid,recommend_start_time:this.formItem.recommend_start_time.length>0?this.formItem.recommend_start_time:0,recommend_end_time:this.formItem.recommend_end_time.length>0?this.formItem.recommend_end_time:0,expected_job_name:this.formItem.expected_job_name,expected_job_salary:this.formItem.expected_job_salary,expected_job_location:this.formItem.expected_job_location,career_length:this.formItem.career_length,expected_job_property:this.formItem.expected_job_property,status:this.formItem.mode,avatarData:this.formItem.avatar,skills:this.formItem.skills,phone:this.formItem.phone,wechat_number:this.formItem.wechat_number,is_male:!0===this.formItem.is_male?1:0,age:this.formItem.age,opusImagesData:this.formItem.opus_images,specialty:this.formItem.specialty,job_experiences:this.formItem.job_experiences};if("edit"===this.usage&&(e.id=this.formItem.id,e.uid=this.formItem.uid),0!==e.job_experiences.length)for(var t in e.job_experiences){var a=e.job_experiences[t],i=new Date(a.start_time);if(e.job_experiences[t].start_time=i.getTime()/1e3,""===a.end_time||"至今"===a.end_time)e.job_experiences[t].end_time=-1;else{var r=new Date(a.end_time);e.job_experiences[t].end_time=r.getTime()/1e3}}return e},submitRequest:function(e){bus.$emit("on-loading");var t=this,a=s.create;"edit"===this.usage&&(a=s.update),this.$Util.api.post(a,e,t).then(function(){t.$Message.success("请求成功"),t.back()},function(e){bus.$emit("on-loading"),t.$Message.warning("请求失败")})},loadResource:function(){var e=this;bus.$emit("on-loading"),this.$Util.api.get(s.resource,e).then(function(t){bus.$emit("on-loading"),e.names=t.options.names,e.career_lengths=t.options.career_lengths,e.properties=t.options.properties,e.salaries=t.options.salaries,e.skill=t.options.skill,e.gender=t.options.gender,e.modes=t.options.modes,e.regions=t.regions,"edit"===e.usage&&e.$nextTick(function(){e.loadResume()}),e.submitEnable=!1},function(t){e.$Message.warning("加载资源失败")})},loadResume:function(){var e=this;bus.$emit("on-loading"),this.$Util.api.get(s.find,e).then(function(t){bus.$emit("on-loading"),t.data.creator||(t.data.creator=[],t.data.creator.uid=0,t.data.creator.nickname=""),t.data.expected_job_name=t.data.expected_job.name,t.data.expected_job_salary=t.data.expected_job.salary,t.data.expected_job_property=t.data.expected_job.property;var a="";switch(t.data.status){case 0:a="在职暂不考虑";break;case 1:a="在职考虑机会";break;case 2:a="离职随时入职";break;case 3:a="离职一周内入职";break;case 4:a="离职月内入职"}t.data.status=a,t.data.defaultAvatar=[{url:t.data.avatar.s.origin}],t.data.avatar=[{url:t.data.avatar.s.origin}],t.data.defaultOpusImages=[];var i=[];t.data.opus_images.map(function(e){t.data.defaultOpusImages.push({url:e.s.origin}),i.push({url:e.s.origin})}),t.data.opus_images=i;var r=new Date;r=t.data.recommend_start_time?r.setTime(1e3*t.data.recommend_start_time):"";var s=new Date;s=t.data.recommend_end_time?s.setTime(1e3*t.data.recommend_end_time):"",t.data.recommend_time=[r,s],e.formItem=t.data,e.submitEnable=!1},function(t){bus.$emit("on-loading"),e.$Message.warning("加载简历详情失败")})},initIds:function(){if("edit"===this.usage){var e=this.id;if(!parseInt(e))return alert("简历id格式有误"),!1;e=parseInt(e),this.formItem.id=e,s.find.api.params.id=e}}},created:function(){this.initIds(),"edit"===this.usage&&(s.resource.api.path="/boss/education/recruitment/resume/edit-page-info"),this.$nextTick(function(){this.loadResource()})}}},so3i:function(e,t,a){var i=a("VU/8")(a("K8bI"),a("NcyF"),null,null);e.exports=i.exports}});