webpackJsonp([147],{Swke:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("m-page-add",[i("m-privilege-card-form",{attrs:{usage:"add"}})],1)},staticRenderFns:[]}},"TYt/":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={create:{api:{path:"/boss/education/recruitment/privilege-card/createMany"}},edit:{api:{path:"/boss/education/recruitment/privilege-card/consumeMany"}},remove:{api:{path:"/boss/education/recruitment/privilege-card/delete",params:{id:0}}},find:{api:{path:"/boss/education/recruitment/privilege-card/find",params:{fields:"{id}",id:0}}},resource:{api:{path:"/boss/education/recruitment/privilege-card/add-page-info",params:{fields:"{categories{name,code},species{id,title,code}}"}},responseHandle:function(e){return e.categories=e.data.form.categories,e.species=e.data.form.species,e}}};t.default={name:"MPrivilegeCardForm",props:{id:{type:String,name:""},usage:{type:String,name:"edit"}},data:function(){return{formItem:{id:0,users:"",groups:[],codes:[]},categories:[],species:[]}},methods:{back:function(){location.hash="/education/recruitment/privilege-card/list"},submit:function(){if(this.validateFormData()){var e=this.getRequestParams();this.submitRequest(e)}},validateFormData:function(){if(0===this.formItem.users.length)return this.$Message.warning("用户ID不能为空"),!1;var e=this.formItem.users.split(",");for(var t in e){var i=e[t];if(parseInt(i,10)!=i||Math.round(i)!=i)return this.$Message.warning("用户 id 格式不正确,请不要包含空格,换行,中文逗号分隔符等非法字符"),!1;e[t]=parseInt(i.trim(),10)}return this.formItem.users=e.join(","),0===this.formItem.groups.length&&"add"===this.usage?(this.$Message.warning("特权卡ID不能为空"),!1):0!==this.formItem.codes.length||"edit"!==this.usage||(this.$Message.warning("特权卡分类不能为空"),!1)},getRequestParams:function(){return{users:this.formItem.users,groups:this.formItem.groups,codes:this.formItem.codes}},submitRequest:function(e){bus.$emit("on-loading");var t=this,i=s.create;"edit"===this.usage&&(i=s.edit),this.$Util.api.post(i,e,t).then(function(){t.$Message.success("请求成功"),t.back()},function(e){bus.$emit("on-loading"),t.$Message.warning("请求失败")})},loadResource:function(){var e=this;bus.$emit("on-loading"),this.$Util.api.get(s.resource,e).then(function(t){bus.$emit("on-loading"),"edit"===e.usage&&(e.categories=t.categories),"add"===e.usage&&(e.species=t.species),e.submitEnable=!1},function(t){e.$Message.warning("加载资源失败")})}},created:function(){"edit"===this.usage&&(s.resource.api.path="/boss/education/recruitment/privilege-card/edit-page-info"),this.$nextTick(function(){this.loadResource()})}}},cfY4:function(e,t,i){var s=i("VU/8")(i("fboz"),i("Swke"),null,null);e.exports=s.exports},fboz:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("w/BU"),r=i.n(s);t.default={name:"app",components:{MPrivilegeCardForm:r.a},data:function(){return{}}}},lhJt:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"padding-top":"20px"}},[i("Form",{attrs:{model:e.formItem,"label-width":100}},["add"===e.usage?i("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("发特权卡")]):e._e(),e._v(" "),"edit"===e.usage?i("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("用特权卡")]):e._e(),e._v(" "),i("Form-item",{attrs:{label:"用户ID"}},[i("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"多个ID用,隔开",type:"textarea",autosize:{minRows:3,maxRows:10}},model:{value:e.formItem.users,callback:function(t){e.$set(e.formItem,"users",t)},expression:"formItem.users"}})],1),e._v(" "),"add"===e.usage?i("Form-item",{attrs:{label:"特权卡活动"}},[i("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",multiple:"",placeholder:"请选择活动"},model:{value:e.formItem.groups,callback:function(t){e.$set(e.formItem,"groups",t)},expression:"formItem.groups"}},e._l(e.species,function(t){return i("Option",{attrs:{value:t.id}},[e._v(e._s(t.title))])}))],1):e._e(),e._v(" "),"edit"===e.usage?i("Form-item",{attrs:{label:"特权卡分类"}},[i("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",multiple:"",placeholder:"请选择分类"},model:{value:e.formItem.codes,callback:function(t){e.$set(e.formItem,"codes",t)},expression:"formItem.codes"}},e._l(e.categories,function(t){return i("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])}))],1):e._e(),e._v(" "),i("Form-item",[i("i-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submit(t)}}},[e._v("提交")]),e._v(" "),i("i-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},nativeOn:{click:function(t){return e.back(t)}}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]}},"w/BU":function(e,t,i){var s=i("VU/8")(i("TYt/"),i("lhJt"),null,null);e.exports=s.exports}});