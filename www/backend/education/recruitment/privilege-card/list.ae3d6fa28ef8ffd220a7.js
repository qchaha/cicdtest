webpackJsonp([244],{"5YXd":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"list",data:function(){return{addRoute:"/education/recruitment/privilege-card/add",api:{path:"/boss/education/recruitment/privilege-card/find-list",params:{fields:"{id,user{uid,nickname,recruitment_related{identity}},privilege_card_category{name,code},valid_start_time,valid_end_time,consume_time}"}},categories:[],pageInfoApi:{path:"/boss/education/recruitment/privilege-card/list-page-info",params:{fields:"{categories{name,code}}"}},columns:[{title:"特权卡记录ID",key:"id"},{title:"用户的昵称 & UID",key:"user",render:function(e,t){return t.row.user?e("div",[e("p",t.row.user.uid),e("p",t.row.user.nickname)]):""}},{title:"用户身份",key:"recruitment_related",render:function(e,t){var i=void 0;switch(t.row.recruitment_related.identity){case 0:default:i="无身份";break;case 1:i="招聘者";break;case 2:i="求职者"}return e("div",[e("p",i)])}},{title:"特权卡",key:"privilege_card_category",render:function(e,t){return t.row.privilege_card_category?e("div",[e("p",t.row.privilege_card_category.name)]):""}},{title:"有效期的开始时间",key:"valid_start_time"},{title:"有效期的结束时间",key:"valid_end_time"},{title:"使用时间",key:"consume_time"},{title:"操作",key:"action",render:function(e,t){return e("m-action-list",{props:{list:[{text:"使用",color:t.row.consume_time?"#f2f3f5":"#f57",disabled:!!t.row.consume_time,click:function(){if(confirm("确认使用?")){var e={api:{path:"/boss/education/recruitment/privilege-card/consume",params:{id:t.row.id}}};bus.$emit("on-loading"),vm.$Util.api.post(e,e.api.params,vm).then(function(e){location.reload()},function(e){bus.$emit("on-loading")})}}}]}})}}],methods:{toAddPrivilegeCard:function(){location.hash="/education/recruitment/privilege-card/add"},toConsumePrivilegeCard:function(){location.hash="/education/recruitment/privilege-card/edit"}},searchCondition:{uid:0,nickname:"",code:"",consume_times:[],valid_times:[],consume_start_time:"",consume_end_time:"",valid_start_time:"",valid_end_time:""},responseHandle:function(e,t){null===e.data||e.data;return e.data.map(function(e){return null!==e.user?e.recruitment_related=e.user.recruitment_related:e.recruitment_related=null,e.valid_start_time=t.$Util.dateFormat(e.valid_start_time,"yyyy-MM-dd hh:mm:ss"),e.valid_end_time=t.$Util.dateFormat(e.valid_end_time,"yyyy-MM-dd hh:mm:ss"),e.consume_time=e.consume_time?t.$Util.dateFormat(e.consume_time,"yyyy-MM-dd hh:mm:ss"):"",e}),e},searchConditionHandle:function(e){return e[e.select]=e.keyword,e.consume_times&&(e.consume_times[0]&&"number"!=typeof e.consume_times[0]?e.consume_start_time=Date.parse(e.consume_times[0])/1e3:e.consume_start_time=0,e.consume_times[1]&&"number"!=typeof e.consume_times[1]?(e.consume_end_time=Date.parse(e.consume_times[1])/1e3,e.consume_end_time=e.consume_end_time+86400-1):e.consume_end_time=0),e.valid_times&&(e.valid_times[0]&&"number"!=typeof e.valid_times[0]?e.valid_start_time=Date.parse(e.valid_times[0])/1e3:e.valid_start_time=0,e.valid_times[1]&&"number"!=typeof e.valid_times[1]?(e.valid_end_time=Date.parse(e.valid_times[1])/1e3,e.valid_end_time=e.valid_end_time+86400-1):e.valid_end_time=0),e}}},methods:{handlePageInfoSuccess:function(e){this.categories=e.data.filter.categories}}}},SAxQ:function(e,t,i){var a=i("VU/8")(i("5YXd"),i("o9Bx"),null,null);e.exports=a.exports},o9Bx:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("m-page-list",{attrs:{path:e.api.path,params:e.api.params,columns:e.columns,"page-info-path":e.pageInfoApi.path,"response-handle":e.responseHandle,"page-info-params":e.pageInfoApi.params},on:{"on-page-info-success":e.handlePageInfoSuccess}},[i("m-action-bar",[i("Button",{attrs:{type:"primary"},on:{click:e.methods.toAddPrivilegeCard}},[e._v("发放")]),e._v(" "),i("Button",{attrs:{type:"primary"},on:{click:e.methods.toConsumePrivilegeCard}},[e._v("使用")])],1),e._v(" "),i("m-action-bar",{attrs:{slot:"search"},slot:"search"},[i("m-action-search-bar",{attrs:{"search-condition":e.searchCondition,"search-condition-handle":e.searchConditionHandle}},[i("m-form-item",[i("Date-picker",{attrs:{type:"daterange",placeholder:"使用时间"},model:{value:e.searchCondition.consume_times,callback:function(t){e.$set(e.searchCondition,"consume_times",t)},expression:"searchCondition.consume_times"}})],1),e._v(" "),i("m-form-item",[i("Date-picker",{attrs:{type:"daterange",placeholder:"有效时间"},model:{value:e.searchCondition.valid_times,callback:function(t){e.$set(e.searchCondition,"valid_times",t)},expression:"searchCondition.valid_times"}})],1),e._v(" "),i("m-form-item",[i("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",placeholder:"请选择分类"},model:{value:e.searchCondition.code,callback:function(t){e.$set(e.searchCondition,"code",t)},expression:"searchCondition.code"}},e._l(e.categories,function(t){return i("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])}))],1),e._v(" "),i("m-form-item",[i("Input",{model:{value:e.searchCondition.keyword,callback:function(t){e.$set(e.searchCondition,"keyword",t)},expression:"searchCondition.keyword"}},[i("Select",{staticStyle:{width:"80px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.searchCondition.select,callback:function(t){e.$set(e.searchCondition,"select",t)},expression:"searchCondition.select"}},[i("Option",{attrs:{value:"uid"}},[e._v("用户ID")]),e._v(" "),i("Option",{attrs:{value:"nickname"}},[e._v("用户昵称")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]}}});