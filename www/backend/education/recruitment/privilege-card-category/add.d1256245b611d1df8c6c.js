webpackJsonp([149],{"8ud5":function(e,t,i){var a=i("VU/8")(i("rQoc"),i("Qmn4"),null,null);e.exports=a.exports},JUrp:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{"padding-top":"20px"}},[i("Form",{attrs:{model:e.formItem,"label-width":100}},[i("Form-item",{attrs:{label:"特权卡分类名字"}},[i("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"","label-in-value":!0,disabled:e.disabled,placeholder:"请选择分类"},on:{"on-change":e.getLabel},model:{value:e.formItem.code,callback:function(t){e.$set(e.formItem,"code",t)},expression:"formItem.code"}},e._l(e.categories,function(t){return i("Option",{attrs:{value:t.code}},[e._v(e._s(t.name))])}))],1),e._v(" "),i("Form-item",{attrs:{label:"使用后提示文案"}},[i("Input",{staticStyle:{width:"300px"},attrs:{maxlength:50,placeholder:"卡片使用提示文案",type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:e.formItem.tip,callback:function(t){e.$set(e.formItem,"tip",t)},expression:"formItem.tip"}})],1),e._v(" "),i("Form-item",{attrs:{label:"生效模式"}},[i("Radio-group",{model:{value:e.formItem.usage_mode,callback:function(t){e.$set(e.formItem,"usage_mode",t)},expression:"formItem.usage_mode"}},[i("Radio",{attrs:{label:"1"}},[e._v("存在即生效")]),e._v(" "),i("Radio",{attrs:{label:"0"}},[e._v("需要使用")])],1)],1),e._v(" "),i("Form-item",{attrs:{label:"权重"}},[i("Input-number",{staticStyle:{width:"200px"},attrs:{max:200,min:1,placeholder:"权重"},model:{value:e.formItem.weight,callback:function(t){e.$set(e.formItem,"weight",t)},expression:"formItem.weight"}})],1),e._v(" "),i("Form-item",{attrs:{label:"功能介绍"}},[i("m-upload-image",{attrs:{"default-images":e.formItem.defaultIntroduceImage},on:{"on-success":e.getIntroduceImage}})],1),e._v(" "),i("Form-item",{attrs:{label:"如何使用"}},[i("m-upload-image",{attrs:{"default-images":e.formItem.defaultHowToUseImage},on:{"on-success":e.getHowToUseImage}})],1),e._v(" "),i("Form-item",{attrs:{label:"查看效果"}},[i("m-upload-image",{attrs:{"default-images":e.formItem.defaultViewTheEffectImage},on:{"on-success":e.getViewTheEffectImage}})],1),e._v(" "),i("Form-item",{attrs:{label:"卡片背景"}},[i("m-upload-image",{attrs:{"default-images":e.formItem.defaultCoverImage},on:{"on-success":e.getCoverImage}})],1),e._v(" "),i("Form-item",[i("i-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submit(t)}}},[e._v("提交")]),e._v(" "),"edit"===e.usage?i("i-button",{attrs:{type:"ghost"},nativeOn:{click:function(t){return e.remove(t)}}},[e._v("删除")]):e._e()],1)],1)],1)},staticRenderFns:[]}},Qmn4:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("m-page-add",[i("m-privilege-card-category-form",{attrs:{usage:"add"}})],1)},staticRenderFns:[]}},SV2l:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={create:{api:{path:"/boss/education/recruitment/privilege-card-category/create"}},update:{api:{path:"/boss/education/recruitment/privilege-card-category/update"}},remove:{api:{path:"/boss/education/recruitment/privilege-card-category/delete",params:{id:0}}},find:{api:{path:"/boss/education/recruitment/privilege-card-category/find",params:{fields:"{id,name,code,tip,usage_mode,weight,introduce_img(w:80){url,width,height,origin},how_to_use_img(w:80){url,width,height,origin},view_the_effect_img(w:80){url,width,height,origin},cover(w:80){url,width,height,origin}}",id:0}}},resource:{api:{path:"/boss/education/recruitment/privilege-card-category/add-page-info",params:{}},responseHandle:function(e){return e.categories=e.data.form.categories,e}}};t.default={name:"MPrivilegeCardCategoryForm",props:{id:{type:String,name:""},usage:{type:String,name:"edit"}},data:function(){return{formItem:{id:0,name:"",code:"",tip:"",usage_mode:1,weight:1,introduce_img:[],how_to_use_img:[],view_the_effect_img:[],cover:[]},categories:[],disabled:!1}},methods:{getLabel:function(e){this.formItem.name=e.label,this.formItem.code=e.value},getIntroduceImage:function(e){this.formItem.introduce_img=e},getHowToUseImage:function(e){this.formItem.how_to_use_img=e},getViewTheEffectImage:function(e){this.formItem.view_the_effect_img=e},getCoverImage:function(e){this.formItem.cover=e},back:function(){location.hash="/education/recruitment/privilege-card-category/list"},remove:function(){if("edit"===this.usage){var e=this.id;if(!parseInt(e))return alert("特权卡分类id格式有误"),!1;e=parseInt(e),this.formItem.id=e,a.remove.api.params.id=e,confirm("确认删除?")&&vm.$Util.api.delete(a.remove).then(this.back())}},submit:function(){if(this.validateFormData()){var e=this.getRequestParams();this.submitRequest(e)}},validateFormData:function(){return 0!==this.formItem.code.length||(this.$Message.warning("特权卡组名称不能为空"),!1)},getRequestParams:function(){var e={name:this.formItem.name,code:this.formItem.code,tip:this.formItem.tip,usage_mode:this.formItem.usage_mode,weight:this.formItem.weight,introduce_img:0===this.formItem.introduce_img.length?[]:this.formItem.introduce_img[0],how_to_use_img:0===this.formItem.how_to_use_img.length?[]:this.formItem.how_to_use_img[0],view_the_effect_img:0===this.formItem.view_the_effect_img.length?[]:this.formItem.view_the_effect_img[0],cover:0===this.formItem.cover.length?[]:this.formItem.cover[0]};return void 0!==e.introduce_img.url&&(e.introduce_img.path=e.introduce_img.url,delete e.introduce_img.url),void 0!==e.how_to_use_img.url&&(e.how_to_use_img.path=e.how_to_use_img.url,delete e.how_to_use_img.url),void 0!==e.view_the_effect_img.url&&(e.view_the_effect_img.path=e.view_the_effect_img.url,delete e.view_the_effect_img.url),void 0!==e.cover.url&&(e.cover.path=e.cover.url,delete e.cover.url),"edit"===this.usage&&(e.id=this.formItem.id),e},submitRequest:function(e){bus.$emit("on-loading");var t=this,i=a.create;"edit"===this.usage&&(i=a.update),this.$Util.api.post(i,e,t).then(function(){t.$Message.success("请求成功"),t.back()},function(e){bus.$emit("on-loading"),t.$Message.warning("请求失败")})},loadResource:function(){var e=this;bus.$emit("on-loading"),this.$Util.api.get(a.resource,e).then(function(t){bus.$emit("on-loading"),e.categories=t.categories,"edit"===e.usage&&e.$nextTick(function(){e.loadPrivilegeCardCategory()}),e.submitEnable=!1},function(t){e.$Message.warning("加载资源失败")})},loadPrivilegeCardCategory:function(){var e=this;bus.$emit("on-loading"),this.$Util.api.get(a.find,e).then(function(t){bus.$emit("on-loading"),t.data.defaultIntroduceImage=t.data.introduce_img?[{url:t.data.introduce_img.origin,height:t.data.introduce_img.height,width:t.data.introduce_img.width}]:[],t.data.introduce_img=t.data.introduce_img?[{url:t.data.introduce_img.origin,height:t.data.introduce_img.height,width:t.data.introduce_img.width}]:[],t.data.defaultHowToUseImage=t.data.how_to_use_img?[{url:t.data.how_to_use_img.origin,height:t.data.how_to_use_img.height,width:t.data.how_to_use_img.width}]:[],t.data.how_to_use_img=t.data.how_to_use_img?[{url:t.data.how_to_use_img.origin,height:t.data.how_to_use_img.height,width:t.data.how_to_use_img.width}]:[],t.data.defaultViewTheEffectImage=t.data.view_the_effect_img?[{url:t.data.view_the_effect_img.origin,height:t.data.view_the_effect_img.height,width:t.data.view_the_effect_img.width}]:[],t.data.view_the_effect_img=t.data.view_the_effect_img?[{url:t.data.view_the_effect_img.origin,height:t.data.view_the_effect_img.height,width:t.data.view_the_effect_img.width}]:[],t.data.defaultCoverImage=t.data.cover?[{url:t.data.cover.origin,height:t.data.cover.height,width:t.data.cover.width}]:[],t.data.cover=t.data.cover?[{url:t.data.cover.origin,height:t.data.cover.height,width:t.data.cover.width}]:[],e.formItem=t.data,e.disabled=!0,e.submitEnable=!1},function(t){bus.$emit("on-loading"),e.$Message.warning("加载特权卡分类详情失败")})},initIds:function(){if("edit"===this.usage){var e=this.id;if(!parseInt(e))return alert("特权卡分类id格式有误"),!1;e=parseInt(e),this.formItem.id=e,a.find.api.params.id=e}}},created:function(){this.initIds(),"edit"===this.usage&&(a.resource.api.path="/boss/education/recruitment/privilege-card-category/edit-page-info"),this.$nextTick(function(){this.loadResource()})}}},rQoc:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("vUnu"),o=i.n(a);t.default={name:"app",components:{MPrivilegeCardCategoryForm:o.a},data:function(){return{}}}},vUnu:function(e,t,i){var a=i("VU/8")(i("SV2l"),i("JUrp"),null,null);e.exports=a.exports}});