webpackJsonp([234],{MvZM:function(e,n){e.exports={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("m-page-list",{attrs:{path:e.api.path,params:e.api.params,columns:e.columns,"sort-key":"ordering","sort-index":5,sortable:"","sort-path":e.sortInfoApi.path,sortable:e.sortable,methods:e.methods,"response-handle":e.responseHandle,"page-info-path":e.pageInfoApi.path,"page-info-params":e.pageInfoApi.params},on:{"on-page-info-success":e.handlePageInfoSuccess}},[t("m-action-bar",[t("Input",{staticStyle:{width:"250px"},attrs:{placeholder:"输入新增学校ID"},model:{value:e.newId,callback:function(n){e.newId=n},expression:"newId"}}),t("Button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("新增")])],1),e._v(" "),t("m-action-bar",{attrs:{slot:"search"},slot:"search"},[t("m-action-search-bar",{attrs:{"search-condition":e.searchCondition,"search-condition-handle":e.searchConditionHandle}},[t("m-form-item",[t("Cascader",{staticStyle:{width:"300px"},attrs:{data:e.regions,"change-on-select":""},model:{value:e.searchCondition.region,callback:function(n){e.$set(e.searchCondition,"region",n)},expression:"searchCondition.region"}})],1),e._v(" "),t("m-form-item",{attrs:{label:""}},[t("Input",{staticStyle:{width:"150px"},attrs:{placeholder:"输入名称搜索"},model:{value:e.searchCondition.name,callback:function(n){e.$set(e.searchCondition,"name",n)},expression:"searchCondition.name"}})],1)],1)],1)],1)},staticRenderFns:[]}},"T/kI":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o={add:{api:{path:"/boss/education/school/hot-school/add"}}},a=null;n.default={name:"app",data:function(){return{api:{path:"/boss/education/school/hot-school/find-list",params:{fields:"{id,name,ordering,all_lessons{id},start_time,end_time,location{city}}"}},sortInfoApi:{path:"/boss/education/school/hot-school/sort"},sortable:!0,pageInfoApi:{path:"/boss/education/school/hot-school/list-page-info",params:{}},newId:"",regions:[],columns:[{title:"学校id",key:"id"},{title:"学校名称",key:"name"},{title:"城市",key:"city",render:function(e,n){return e("p",n.row.location.city)}},{title:"所含课程数",key:"lessonCount",render:function(e,n){return e("span",n.row.all_lessons.length)}},{title:"操作",key:"action",render:function(e,n){var t=[];return[{name:"编辑",handle:function(){location.hash="/education/school/school/edit/"+n.row.id}},{name:"从热门学校移除",handle:function(){confirm("确认移除?")&&(bus.$emit("on-loading"),vm.$Util.api.delete({api:{path:"/boss/education/school/hot-school/delete",params:{id:n.row.id}}},vm).then(function(){location.reload()},function(e){alert(e)}))}}].map(function(n){t.push(e("i-button",{props:{type:"text",size:"small"},on:{click:function(){n.handle()}}},[e("span",{style:{color:"#39f"}},n.name)]))}),e("div",t)}}],responseHandle:function(e,n){return e},searchConditionHandle:function(e){var n=0;return e[e.select]=e.keyword,e.region&&(e.province_id=e.region[0],n=void 0===e.province_id?0:e.province_id,e.city_id=e.region[1]),a.sortable=0===n&&""==e.name,e},searchCondition:{name:"",region:[],province_id:0,city_id:0}}},methods:{handlePageInfoSuccess:function(e){var n=[];for(var t in e.data.filter.regions){var o=e.data.filter.regions[t],a={value:o.area_code,label:o.name,children:[]};for(var i in o.cities){var s=o.cities[i],r={value:s.area_code,label:s.name,children:[]};a.children.push(r)}n.push(a)}e.data.filter.regions=n,this.regions=n},handleSubmit:function(){if(""===this.newId||"0"===this.newId)return this.$Notice.warning({title:"学校ID不能为空",desc:""}),!1;if(!isNaN(this.newId)){bus.$emit("on-loading");var e={id:this.newId};vm.$Util.api.post(o.add,e,vm).then(function(){location.reload()},function(){})}}},created:function(){a=this}}},bq5W:function(e,n,t){var o=t("VU/8")(t("T/kI"),t("MvZM"),null,null);e.exports=o.exports}});