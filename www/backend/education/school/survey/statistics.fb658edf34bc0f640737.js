webpackJsonp([178],{NPu4:function(e,t,i){var s=i("NX2D");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i("rjj0")("454decae",s,!0)},NX2D:function(e,t,i){t=e.exports=i(0)(),t.push([e.i,".layout[data-v-280a5bcd]{border:1px solid #d7dde4;background:#f5f7f9;position:relative;border-radius:4px;overflow:hidden}",""])},YM2g:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("m-page",[i("Layout",{staticClass:"layout"},[i("h2",[e._v("\n            当前: "+e._s(e.period.lesson.school.location.province)+" "+e._s(e.period.lesson.school.location.city)+" "+e._s(e.period.lesson.school.location.summary)+" "+e._s(e.period.lesson.school.name)+" "+e._s(e.period.title)+"课程 评价情况\n        ")])]),e._v(" "),i("Layout",{staticClass:"layout"},[i("Header",[i("H1",[e._v("已提交"+e._s(e.answer_count)+"/"+e._s(e.user_count)+"个反馈")]),e._v(" "),i("Button",{attrs:{type:"primary"},on:{click:function(t){e.exportExcel("question")}}},[e._v("excel导出")])],1),e._v(" "),i("Layout",{staticClass:"layout"},[i("Content",e._l(e.questions,function(t,s){return i("div",[1==t.type?i("ul",[i("li",[e._v(e._s(s+1)+" . "+e._s(t.title))]),e._v(" "),e._l(t.user_answers,function(t){return i("li",[e._v("\n                            "+e._s(t.field1)+"\n                            "),i("Progress",{attrs:{percent:t.field2>0?t.field2/e.answer_count*100:0}},[i("span",[e._v(e._s(t.field2))])])],1)})],2):e._e(),e._v(" "),2==t.type?i("ul",[i("li",[e._v(e._s(s+1)+" . "+e._s(t.title))]),e._v(" "),e._l(t.user_answers,function(t){return i("li",[i("span",[e._v(e._s(t.field1))]),e._v(" : "),i("span",[e._v(e._s(t.field2))])])})],2):e._e()])}))],1)],1),e._v(" "),i("Layout",[i("Header",[i("H1",[e._v("详细反馈提交情况")]),e._v(" "),i("Button",{attrs:{type:"primary"},on:{click:function(t){e.exportExcel("user_answer")}}},[e._v("excel导出")])],1),e._v(" "),i("Layout",[i("Content",[i("div",[i("Table",{attrs:{columns:e.columns,data:e.users}})],1)])],1)],1)],1)},staticRenderFns:[]}},lZiY:function(e,t,i){i("NPu4");var s=i("VU/8")(i("xdkz"),i("YM2g"),"data-v-280a5bcd",null);e.exports=s.exports},xdkz:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"MSurveyStatics",props:{periodId:{type:String}},data:function(){var e={id:"22",title:"title",lesson:{id:"34",title:"",school:{name:"",location:{province:"",city:"",district:"",summary:""}}}};return{statisticsUsersApi:{api:{path:"/boss/education/school/survey/statistics_users",params:{period_id:this.$route.params.periodId,fields:"{uid,user_name,survey_info}"}}},statisticsQuestionsApi:{api:{path:"/boss/education/school/survey/statistics_questions",params:{period_id:this.$route.params.periodId,fields:"{id,title,user_answers,type,answer_options}"}}},findPeriodApi:{api:{path:"/boss/education/school/lesson-period/find",params:{id:this.$route.params.periodId,fields:"{id,title,lesson{id,title,school{name,location{province,city,district,summary}}}}"}}},exportApi:{api:{path:"/boss/education/school/survey/export",params:{type:"question",period_id:this.$route.params.periodId}}},period:e,questions:[{title:"question1",type:1,user_answers:[{field1:"this is a",field2:"0"},{field1:"this is b",field2:"0"}]},{title:"question2",type:3,user_answers:[{field1:"爱米(4)",field2:"ha ha ha ,this is all ***"}]}],columns:[{title:"UID",key:"uid"},{title:"昵称",key:"user_name"},{title:"手机号",key:"phone",render:function(e,t){return e("span",void 0!==t.row.survey_info.phone?t.row.survey_info.phone:"")}},{title:"状态",key:"status",render:function(e,t){return e("span",void 0!==t.row.survey_info.status_name?t.row.survey_info.status_name:"")}},{title:"提交时间",key:"create_time",render:function(e,t){var i=void 0!==t.row.survey_info.create_time?t.row.survey_info.create_time:"";if(i)var s=function(e,t){var i="0";return i=i.repeat(t)+e,i.substring(i.length-t,i.length)},o=new Date(1e3*i),n=o.getFullYear(),r=o.getMonth()+1,a=o.getDate(),u=o.getHours(),d=o.getMinutes(),l=o.getSeconds(),c=n+"-"+s(r,2)+"-"+s(a,2)+" "+s(u,2)+":"+s(d,2)+":"+s(l,2);else c="";return e("span",c)}},{title:"操作",key:"create_time",render:this.rd}],users:[{user_name:"user_name",uid:2333,survey_info:{phone:"1555555",status:"未提交",create_time:"1517210575"}}],user_count:0,answer_count:0}},methods:{rd:function(e,t){var i=this,s=[];return[{name:"查看详情",handle:function(){var e=window.location.host,s=e.replace(/(meijialove\.com)|(\.meijialove\.com)|(\.meijiabang\.cn)/,""),o="";"www"===s||""===s?o+="https://m.meijiabang.cn/single-page/survey-question/index.html?lessonId="+i.period.lesson.id+"&periodId="+i.period.id+"&token="+t.row.survey_info.token+"&uid="+t.row.uid:(o+="http://h5.meijiabang.cn/single-page/survey-question/index.html?lessonId="+i.period.lesson.id+"&periodId="+i.period.id+"&token="+t.row.survey_info.token+"&uid="+t.row.uid,o+="&test_host="+s),window.open(o)}}].map(function(t){s.push(e("i-button",{props:{type:"text",size:"small"},on:{click:function(){t.handle()}}},[e("span",{style:{color:"#39f"}},t.name)]))}),e("div",s)},loadPeriod:function(){var e=this;this.$Util.api.get(e.findPeriodApi,e).then(function(t){e.period=t.data},function(t){e.$Notice.warning({title:"加载学时详情失败",desc:""})})},loadQuestions:function(){var e=this;this.$Util.api.get(e.statisticsQuestionsApi,e).then(function(t){e.questions=t.data},function(t){e.$Notice.warning({title:"加载问卷统计失败",desc:""})})},loadUsers:function(){var e=this;this.$Util.api.get(e.statisticsUsersApi,e).then(function(t){e.users=t.data,e.user_count=t.data.length;for(var i=0,s=t.data.length;s--;){var o=t.data[s];void 0!==o.survey_info.create_time&&o.survey_info.create_time&&i++}e.answer_count=i},function(t){e.$Notice.warning({title:"加载问卷统计失败",desc:""})})},exportExcel:function(e){var t=this.exportApi;t.api.params.type=e;var i=this.exportApi.api.path;i+="?type="+e+"&period_id="+this.exportApi.api.params.period_id,window.open(i)}},mounted:function(){this.$nextTick(function(){this.loadPeriod(),this.loadQuestions(),this.loadUsers()})}}}});