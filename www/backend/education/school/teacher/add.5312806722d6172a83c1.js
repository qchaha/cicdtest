webpackJsonp([137],{"22tl":function(t,e,a){var i=a("VU/8")(a("L4jy"),a("LkpC"),null,null);t.exports=i.exports},"8DOe":function(t,e,a){var i=a("VU/8")(a("H7XE"),a("M2BF"),null,null);t.exports=i.exports},H7XE:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("22tl"),r=a.n(i);e.default={name:"app",components:{MTeacherForm:r.a},data:function(){return{}}}},L4jy:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={create:{api:{path:"/boss/education/school/teacher/create"}},update:{api:{path:"/boss/education/school/teacher/update"}},find:{api:{path:"/boss/education/school/teacher/find",params:{fields:"{id,name,title,award,type,uid,specialty,introduction,avatar{s(w:80,h:80){url,origin}}}",teacherId:0}}}};e.default={name:"MTeacherForm",props:{id:{type:String,default:""},usage:{type:String,default:"edit"}},data:function(){return{formItem:{id:0,name:"",title:"",award:"",avatar:[],defaultAvatar:[],uid:0,specialty:"",introduction:"",type:"0"},ruleValidate:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],title:[{required:!0,message:"职称不能为空",trigger:"blur"}],award:[{required:!0,message:"获奖情况不能为空",trigger:"blur"}],specialty:[{required:!0,message:"擅长内容不能为空",trigger:"blur"}],introduction:[{required:!0,message:"老师简介不能为空",trigger:"blur"}],uid:[{required:!0,message:"uid不能为空",trigger:"blur"}],type:[{required:!0,message:"教师来源不能为空",trigger:"change"}]},types:[{id:"0",name:"线下课"},{id:"1",name:"线上课"},{id:"2",name:"教程"}]}},methods:{syncAvatar:function(t){this.formItem.avatar=t},back:function(){location.hash="/education/school/teacher/list"},submit:function(t){var e=this;this.$refs[t].validate(function(t){if(t&&e.validateFormData()){var a=e.getRequestParams();e.submitRequest(a)}else e.$Message.error("表单验证失败!")})},validateFormData:function(){return 0!==this.formItem.avatar.length||(this.$Notice.warning({title:"必须上传头像",desc:""}),!1)},getRequestParams:function(){var t={name:this.formItem.name,title:this.formItem.title,award:this.formItem.award,type:this.formItem.type,uid:this.formItem.uid,specialty:this.formItem.specialty,introduction:this.formItem.introduction,avatar:""};return this.formItem.avatar.map(function(e){""!==e.url&&(t.avatar=e.url)}),"edit"===this.usage&&(t.teacherId=this.formItem.id),t},submitRequest:function(t){bus.$emit("on-loading");var e=this,a=i.create;"edit"===this.usage&&(a=i.update),this.$Util.api.post(a,t,e).then(function(){e.$Message.success("请求成功"),e.back()},function(){bus.$emit("on-loading"),e.$Message.warning("请求失败")})},loadTeacher:function(){bus.$emit("on-loading");var t=this;this.$Util.api.get(i.find,t).then(function(e){bus.$emit("on-loading"),t.formItem.name=e.data.name,t.formItem.title=e.data.title,t.formItem.award=e.data.award,t.formItem.type=e.data.type+"",t.formItem.uid=e.data.uid+"",t.formItem.specialty=e.data.specialty,t.formItem.introduction=e.data.introduction,t.formItem.avatar=[{url:e.data.avatar.s.origin}],t.formItem.defaultAvatar=[{url:e.data.avatar.s.origin}]},function(e){bus.$emit("on-loading"),t.$Message.warning("加载老师详情失败")})}},created:function(){var t=this.id;if(!parseInt(t)&&"edit"===this.usage)return alert("老师id格式有误"),!1;t=parseInt(t),this.formItem.id=t,i.find.api.params.teacherId=t,"edit"===this.usage&&this.$nextTick(function(){this.loadTeacher()})}}},LkpC:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"padding-top":"20px"}},[a("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":60,rules:t.ruleValidate}},[a("Form-item",{attrs:{label:"教师名称",prop:"name"}},[a("i-input",{staticStyle:{width:"300px"},attrs:{maxlength:100,placeholder:"教师名称(100字以内)"},model:{value:t.formItem.name,callback:function(e){t.$set(t.formItem,"name",e)},expression:"formItem.name"}})],1),t._v(" "),a("Form-item",{attrs:{label:"教师职称",prop:"title"}},[a("i-input",{staticStyle:{width:"300px"},attrs:{maxlength:300,placeholder:"教师职称(300字以内)"},model:{value:t.formItem.title,callback:function(e){t.$set(t.formItem,"title",e)},expression:"formItem.title"}})],1),t._v(" "),a("Form-item",{attrs:{required:"",label:"教师头像"}},[a("m-upload-image",{attrs:{"default-images":t.formItem.defaultAvatar},on:{"on-success":t.syncAvatar}})],1),t._v(" "),a("Form-item",{attrs:{label:"教师获奖情况",prop:"award"}},[a("i-input",{staticStyle:{width:"300px"},attrs:{maxlength:300,placeholder:"教师获奖情况(300字以内)"},model:{value:t.formItem.award,callback:function(e){t.$set(t.formItem,"award",e)},expression:"formItem.award"}})],1),t._v(" "),a("Form-item",{attrs:{label:"教师擅长内容",prop:"specialty"}},[a("i-input",{staticStyle:{width:"300px"},attrs:{maxlength:300,placeholder:"教师擅长内容(300字以内)"},model:{value:t.formItem.specialty,callback:function(e){t.$set(t.formItem,"specialty",e)},expression:"formItem.specialty"}})],1),t._v(" "),a("Form-item",{attrs:{label:"教师简介",prop:"introduction"}},[a("i-input",{attrs:{maxlength:3e3,type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"教师简介(3000字以内)"},model:{value:t.formItem.introduction,callback:function(e){t.$set(t.formItem,"introduction",e)},expression:"formItem.introduction"}})],1),t._v(" "),a("Form-item",{attrs:{label:"教师来源",prop:"type"}},[a("i-select",{staticStyle:{width:"260px"},model:{value:t.formItem.type,callback:function(e){t.$set(t.formItem,"type",e)},expression:"formItem.type"}},t._l(t.types,function(e){return a("i-option",{attrs:{value:e.id,id:t.types.id}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("Form-item",{staticStyle:{width:"340px"},attrs:{label:"教师UID",prop:"uid"}},[a("i-input",{staticStyle:{width:"300px"},attrs:{maxlength:10,placeholder:"输入教师在美甲帮app的UID"},model:{value:t.formItem.uid,callback:function(e){t.$set(t.formItem,"uid",e)},expression:"formItem.uid"}})],1),t._v(" "),a("Form-item",[a("i-button",{attrs:{type:"primary"},on:{click:function(e){t.submit("formItem")}}},[t._v("提交")]),t._v(" "),a("i-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.back}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]}},M2BF:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("m-page-edit",[a("m-teacher-form",{attrs:{usage:"add"}})],1)},staticRenderFns:[]}}});