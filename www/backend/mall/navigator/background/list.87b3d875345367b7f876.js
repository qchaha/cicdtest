webpackJsonp([210],{"16jp":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("m-page-list",{attrs:{path:t.api.path,params:t.api.params,columns:t.columns,methods:t.methods,"response-handle":t.responseHandle,"page-info-path":t.pageInfoApi.path,"page-info-params":t.pageInfoApi.params}},[a("m-action-bar",[a("Button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.addRoute(e)}}},[t._v("新建")])],1),t._v(" "),a("m-action-bar",{attrs:{slot:"search"},slot:"search"},[a("m-action-search-bar",{attrs:{"search-condition":t.searchCondition,"search-condition-handle":t.handleSearchCondition}},[a("m-form-item",{attrs:{label:"页面标题"}},[a("Input",{staticStyle:{width:"150px","margin-right":"10px"},attrs:{placeholder:"输入页面标题"},model:{value:t.searchCondition.memo,callback:function(e){t.$set(t.searchCondition,"memo",e)},expression:"searchCondition.memo"}})],1),t._v(" "),a("m-form-item",{attrs:{label:"展示对象"}},[a("Select",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{multiple:"",clearable:"",placeholder:"请选择展示对象"},model:{value:t.searchCondition.audience,callback:function(e){t.$set(t.searchCondition,"audience",e)},expression:"searchCondition.audience"}},t._l(t.audienceTypes,function(e){return a("Option",{key:e,attrs:{value:e.title}},[t._v(t._s(e.title))])}))],1),t._v(" "),a("m-form-item",{attrs:{label:"页面状态"}},[a("Select",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{multiple:"",clearable:"",placeholder:"请选择页面状态"},model:{value:t.searchCondition.status,callback:function(e){t.$set(t.searchCondition,"status",e)},expression:"searchCondition.status"}},t._l(t.statusList,function(e){return a("Option",{key:e,attrs:{value:e.name}},[t._v(t._s(e.name))])}))],1),t._v(" "),a("m-form-item",{attrs:{label:"开始时间范围"}},[a("Date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择开始时间"},model:{value:t.searchCondition.start_time,callback:function(e){t.$set(t.searchCondition,"start_time",e)},expression:"searchCondition.start_time"}})],1),t._v(" "),a("m-form-item",{attrs:{label:"结束时间范围"}},[a("Date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择结束时间"},model:{value:t.searchCondition.end_time,callback:function(e){t.$set(t.searchCondition,"end_time",e)},expression:"searchCondition.end_time"}})],1)],1)],1)],1)},staticRenderFns:[]}},Hnqr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"app",data:function(){return{addRoute:function(){location.hash="/mall/navigator/background/add"},api:{path:"/boss/mall/navigator/background/find-list",params:{fields:"{id,memo,start_time,end_time,audience,audience_name,status_name,status}",status:["待发布","已发布"]}},pageInfoApi:{path:"/boss/mall/navigator/background/list-page-info",params:{}},audienceListApi:{api:{path:"/boss/mall/navigator/background/get-audience-list"}},statusListApi:{api:{path:"/boss/mall/navigator/background/get-status-list"}},statusList:[{name:"已发布"},{name:"待发布"},{name:"已下线"},{name:"已作废"}],audienceTypes:[{title:"不限"},{title:"uid"},{title:"不限2"}],searchCondition:{memo:"",status:["待发布","已发布"],audience:[],start_time:"",end_time:""},columns:[{title:"ID",key:"id"},{title:"标题",key:"memo",width:250,render:function(t,e){return t("div",e.row.memo.length>50?e.row.memo.substr(0,50)+"...":e.row.memo)}},{title:"展示对象",key:"audience_name",width:120},{title:"开始时间",key:"start_time",width:120},{title:"结束时间",key:"end_time",width:120},{title:"状态",key:"status_name",render:function(t,e){var a="red";switch(e.row.status_name){case"已作废":a="red";break;case"待发布":a="black";break;case"已发布":a="green";break;case"已下线":a="grey"}return t("div",{style:{color:a}},e.row.status_name)}},{title:"操作",key:"action",render:function(t,e){var a=[t("i-button",{props:{type:"text",size:"small"},on:{click:function(){location.hash="/mall/navigator/background/edit/"+e.row.id}}},[t("span",{style:{color:"#39f"}},"编辑")]),t("i-button",{props:{type:"text",size:"small"},on:{click:function(){location.hash="/mall/navigator/background/copy/"+e.row.id}}},[t("span",{style:{color:"#39f"}},"复制")])];return e.row.status?a.push(t("i-button",{props:{type:"text",size:"small"},on:{click:function(){if(confirm("确认作废?")){var t={api:{path:"/boss/mall/navigator/background/cancellation",params:{id:e.row.id}}};bus.$emit("on-loading"),vm.$Util.api.delete(t,vm).then(function(t){vm.$Notice.success({title:"作废成功",desc:""}),bus.$emit("on-loading"),location.reload()},function(t){vm.$Notice.warning({title:"作废失败",desc:t.error_message}),bus.$emit("on-loading")})}}}},[t("span",{style:{color:"red"}},"作废")])):a.push(t("i-button",{props:{type:"text",size:"small"},on:{click:function(){if(confirm("确认恢复?")){var t={api:{path:"/boss/mall/navigator/background/recover",params:{id:e.row.id}}};bus.$emit("on-loading"),vm.$Util.api.post(t,t.api.params,vm).then(function(t){vm.$Notice.success({title:"恢复成功",desc:""}),location.reload(),bus.$emit("on-loading")},function(t){vm.$Notice.warning({title:"恢复失败",desc:t.error_message}),bus.$emit("on-loading")})}}}},[t("span",{style:{color:"green"}},"恢复")])),t("div",a)}}],methods:{},responseHandle:function(t,e){var a=t.data;for(var i in a)a[i].start_time=e.$Util.dateFormat(a[i].start_time,"yyyy-MM-dd<br>hh:mm:ss"),a[i].end_time=e.$Util.dateFormat(a[i].end_time,"yyyy-MM-dd<br>hh:mm:ss");return t},handleSearchCondition:function(t){return""!=t.start_time&&"number"!=typeof t.start_time&&(t.start_time=t.start_time.getTime()),""!=t.end_time&&"number"!=typeof t.end_time&&(t.end_time=t.end_time.getTime()),t}}},methods:{loadAudienceTypes:function(){var t=this;this.$Util.api.get(t.audienceListApi,t).then(function(e){t.audienceTypes=e.data},function(e){t.$Notice.warning({title:"加载详情失败",desc:""})})},loadStatus:function(){var t=this;this.$Util.api.get(t.statusListApi,t).then(function(e){t.statusList=e.data},function(e){t.$Notice.warning({title:"加载详情失败",desc:""})})}},created:function(){this.$nextTick(function(){this.loadAudienceTypes()})}}},"PJI/":function(t,e,a){var i=a("VU/8")(a("Hnqr"),a("16jp"),null,null);t.exports=i.exports}});