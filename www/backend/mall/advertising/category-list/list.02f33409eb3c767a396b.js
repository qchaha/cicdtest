webpackJsonp([227],{Beot:function(t,e,a){var i=a("VU/8")(a("sc/n"),a("ZfeW"),null,null);t.exports=i.exports},ZfeW:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("m-page-list",{attrs:{path:t.listApi.path,params:t.listApi.params,columns:t.columns,"response-handle":t.responseHandle,"page-info-path":t.listPageInfoApi.path,"page-info-params":t.listPageInfoApi.params}},[a("m-action-bar",[a("m-action-button-add",{attrs:{route:t.addRoute}})],1),t._v(" "),a("m-action-bar",{attrs:{slot:"search"},slot:"search"},[a("m-action-search-bar",{attrs:{"search-condition":t.searchCondition,"search-condition-handle":t.searchConditionHandle}},[a("m-form-item",{attrs:{label:"页面名称"}},[a("Input",{staticStyle:{width:"150px","margin-right":"10px"},model:{value:t.searchCondition.name,callback:function(e){t.$set(t.searchCondition,"name",e)},expression:"searchCondition.name"}})],1),t._v(" "),a("m-form-item",{attrs:{label:"展示对象"}},[a("i-select",{staticStyle:{width:"150px"},attrs:{multiple:""},model:{value:t.searchCondition.audience,callback:function(e){t.$set(t.searchCondition,"audience",e)},expression:"searchCondition.audience"}},t._l(t.searchTypeSource,function(e){return a("i-option",{attrs:{value:e.audience}},[t._v(t._s(e.title))])}))],1),t._v(" "),a("m-form-item",{attrs:{label:""}},[a("Date-picker",{attrs:{type:"datetime",placeholder:"开始日期"},model:{value:t.searchCondition.start_time,callback:function(e){t.$set(t.searchCondition,"start_time",e)},expression:"searchCondition.start_time"}})],1),t._v(" "),a("span",[t._v("-")]),t._v(" "),a("m-form-item",[a("Date-picker",{attrs:{type:"datetime",placeholder:"结束日期"},model:{value:t.searchCondition.end_time,callback:function(e){t.$set(t.searchCondition,"end_time",e)},expression:"searchCondition.end_time"}})],1),t._v(" "),a("m-form-item",{attrs:{label:"显示状态"}},[a("i-select",{staticStyle:{width:"200px"},attrs:{multiple:""},model:{value:t.searchCondition.state,callback:function(e){t.$set(t.searchCondition,"state",e)},expression:"searchCondition.state"}},[a("i-option",{attrs:{value:0}},[t._v("已废弃")]),t._v(" "),a("i-option",{attrs:{value:1}},[t._v("已发布")]),t._v(" "),a("i-option",{attrs:{value:2}},[t._v("已下线")]),t._v(" "),a("i-option",{attrs:{value:3}},[t._v("待发布")])],1)],1)],1)],1)],1)},staticRenderFns:[]}},"sc/n":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={resource:{api:{path:"/boss/mall/advertising/home/tag-group-info"}}};e.default={name:"MCategoryList",data:function(){return{searchTypeSource:{},addRoute:"/mall/advertising/category-list/add",listApi:{path:"/boss/mall/advertising/category-list/find-list",params:{fields:"{id,name,audience_name,start_time,end_time,state}",state:[1,3]}},listPageInfoApi:{path:"/boss/mall/advertising/category-list/list-page-info",params:{state:[1,3]}},searchCondition:{name:"",audience:[],start_time:"",end_time:"",state:[1,3]},columns:[{title:"页面id",key:"id"},{title:"页面名称",key:"name"},{title:"展示对象",key:"audience_name",render:function(t,e){return""===e.row.audience_name?t("div",{},"不限"):t("div",{},e.row.audience_name)}},{title:"开始时间",key:"start_time"},{title:"结束时间",key:"end_time"},{title:"状态",key:"status"},{title:"操作",key:"action",render:function(t,e){var a=[],i=[{name:"编辑",handle:function(){location.hash="/mall/advertising/category-list/edit/"+e.row.id}},{name:"详情",handle:function(){location.hash="/mall/advertising/category-list/category-information/list/"+e.row.id}},{name:"复制",handle:function(){if(confirm("确定要复制吗?")){var t={api:{path:"/boss/mall/advertising/category-list/copy",params:{id:e.row.id}}};bus.$emit("on-loading"),vm.$Util.api.post(t,t.api.params,vm).then(function(t){null!==t.data?location.hash="/mall/advertising/category-list/category-information/list/"+t.data:alert("复制失败，请联系开发人员")},function(t){alert(t)})}}}];return 0===e.row.state?i.push({name:"恢复",handle:function(){bus.$emit("on-loading"),vm.$Util.api.get({api:{path:"/boss/mall/advertising/category-list/recovery",params:{id:e.row.id}}},vm).then(function(){location.reload()},function(t){alert(t)})}}):i.push({name:"废弃",handle:function(){1===e.row.state?confirm("此为App当前展示页面,确定要废除吗?")&&(bus.$emit("on-loading"),vm.$Util.api.delete({api:{path:"/boss/mall/advertising/category-list/delete",params:{id:e.row.id}}},vm).then(function(){alert("页面已成功作废，不会发布上线")},function(t){alert(t)})):(bus.$emit("on-loading"),vm.$Util.api.delete({api:{path:"/boss/mall/advertising/category-list/delete",params:{id:e.row.id}}},vm).then(function(){alert("页面已成功作废，不会发布上线")},function(t){alert(t)}))}}),i.map(function(e){a.push(t("i-button",{props:{type:"text",size:"small"},on:{click:function(){e.handle()}}},[t("span",{style:{color:"#39f"}},e.name)]))}),t("div",a)}}],responseHandle:function(t){var e=null===t.data?[]:t.data;for(var a in e)switch(e[a].start_time=vm.$Util.dateFormat(e[a].start_time,"yyyy-MM-dd<br>hh:mm:ss"),e[a].end_time=vm.$Util.dateFormat(e[a].end_time,"yyyy-MM-dd<br>hh:mm:ss"),e[a].state){case 0:e[a].status='<p style="color:#ff3300;">已作废</p>';break;case 1:e[a].status='<p style="color:#00cc66;">已发布</p>';break;case 2:e[a].status='<p style="color:#9ea7b4;">已下线</p>';break;case 3:e[a].status='<p style="color:#ff9900;">待发布</p>'}return t},searchConditionHandle:function(t){t.start_time&&(t.start_time=Date.parse(t.start_time)),t.end_time&&(t.end_time=Date.parse(t.end_time));for(var e=0;e<t.audience.length;e++)""===t.audience[e]&&(t.audience[e]="no_tag");return t}}},methods:{loadResource:function(){var t=this;this.$Util.api.get(i.resource,t).then(function(e){e.data.unshift({audience:"no_tag",title:"不限"}),t.searchTypeSource=e.data},function(e){t.$Message.warning("加载资源失败")})}},created:function(){this.$nextTick(function(){this.loadResource()})}}}});