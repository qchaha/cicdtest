webpackJsonp([220],{MCm7:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("L66W"),s=o.n(i);e.default={components:{MPageEdit:s.a},name:"goodsAttributeEdit",data:function(){return{goods_id:this.$route.query.goods_id,attributes:[],goodsAttributes:[]}},methods:{loadAttributes:function(){var t=this;return this.$Util.api.get({api:{path:"/boss/mall/catalog/attribute/find-list",params:{fields:"{code,name,type,items}",offset:0,limit:1e3}}}).then(function(e){t.attributes=e.data,t.loadGoodsData(t.goods_id)},function(e){bus.$emit("on-loading"),t.$Modal.error({width:300,title:"错误提示",content:e.error_description?e.error_description:e.error_message})}),!0},loadGoodsData:function(t){var e=this;this.$Util.api.get({api:{path:"/boss/mall/catalog/goods/find?id="+t,params:{fields:"{allAttributes}"}}}).then(function(t){if(bus.$emit("on-loading"),0===t.data.allAttributes.length)e.goodsAttributes={};else{e.goodsAttributes=t.data.allAttributes;for(var o=0;o<e.attributes.length;o++){var i=e.attributes[o].type,s=e.attributes[o].code;2==i&&e.goodsAttributes[s]&&(e.goodsAttributes[s]=e.goodsAttributes[s].split(";"))}}},function(t){bus.$emit("on-loading"),e.$Modal.error({width:300,title:"错误提示",content:t.error_description?t.error_description:t.error_message})})},reset:function(){this.goodsAttributes=[]},submit:function(){bus.$emit("on-loading"),this.$Util.api.post({api:{path:"/boss/mall/catalog/goods/update-goods-attribute"}},{attrs:this.goodsAttributes,goodsId:this.$route.query.goods_id}).then(function(t){0===parseInt(t.error_code)?(this.$Notice.success({title:"设置成功",desc:""}),bus.$emit("on-loading"),location.hash="/mall/catalog/goods/list"):(this.$Notice.warning({title:"设置失败",desc:t.error_description}),bus.$emit("on-loading"))},function(t){bus.$emit("on-loading"),this.$Notice.warning({title:"设置失败"})})}},created:function(){var t=this;this.$nextTick(function(){t.goods_id?(bus.$emit("on-loading"),t.loadAttributes()):t.$Modal.error({width:260,title:"错误提示",content:"非法操作：缺少必要参数"})})}}},"Y/ad":function(t,e,o){var i=o("VU/8")(o("MCm7"),o("cS6j"),null,null);t.exports=i.exports},cS6j:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("m-page-edit",[o("Card",[o("Form",{ref:"formValidate",staticClass:"fixed-width-form",attrs:{"label-width":100}},[t._l(t.attributes,function(e){return o("Form-item",{attrs:{label:e.name}},[1===e.type?o("RadioGroup",{model:{value:t.goodsAttributes[e.code],callback:function(o){t.$set(t.goodsAttributes,e.code,o)},expression:"goodsAttributes[attrParam.code]"}},t._l(e.items,function(t){return o("Radio",{attrs:{label:t}})})):t._e(),t._v(" "),2===e.type?o("CheckboxGroup",{model:{value:t.goodsAttributes[e.code],callback:function(o){t.$set(t.goodsAttributes,e.code,o)},expression:"goodsAttributes[attrParam.code]"}},[o("span",{staticStyle:{color:"red"}},[t._v("(多选项)")]),t._v(" "),t._l(e.items,function(t){return o("Checkbox",{attrs:{label:t}})})],2):t._e()],1)}),t._v(" "),o("Form-item",[o("Button",{attrs:{type:"primary"},on:{click:function(e){t.submit()}}},[t._v("提交")]),t._v(" "),o("Button",{staticClass:"btn-blue-border",attrs:{type:"ghost"},on:{click:function(e){t.reset()}}},[t._v("重置")])],1)],2)],1)],1)},staticRenderFns:[]}}});