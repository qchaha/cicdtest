webpackJsonp([114],{"2k71":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("m-page-edit",{attrs:{"is-loading":t.loadingState}},[a("m-goodsCategory-form",{attrs:{usage:"add"},on:{loading:t.changeLoadingState}})],1)},staticRenderFns:[]}},HSlv:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"padding-top":"20px"}},[a("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":80,rules:t.ruleValidate}},[a("Form-item",{attrs:{label:"分类名称",prop:"cateName"}},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"分类名称"},model:{value:t.formItem.cateName,callback:function(e){t.$set(t.formItem,"cateName",e)},expression:"formItem.cateName"}})],1),t._v(" "),a("Form-item",{attrs:{label:"父级分类"}},[a("Select",{staticStyle:{width:"260px"},attrs:{filterable:""},model:{value:t.formItem.parentId,callback:function(e){t.$set(t.formItem,"parentId",e)},expression:"formItem.parentId"}},t._l(t.categoryInfo,function(e){return a("Option",{attrs:{value:e.cate_id}},[t._v(t._s(e.cate_name))])})),t._v("(不选择表示顶级分类)\n        ")],1),t._v(" "),a("Form-item",{attrs:{label:"分类图标"}},[a("m-upload-image",{attrs:{"default-images":t.defaultIcon},on:{"on-success":t.syncIcon}})],1),t._v(" "),"edit"==t.usage?a("Form-item",{attrs:{label:"APP路由链接"}},[t._v("\n            "+t._s(t.formItem.appRoute)+"\n        ")]):t._e(),t._v(" "),a("Form-item",{attrs:{label:"是否在分类列表展示"}},[a("Radio-group",{model:{value:t.formItem.isShow,callback:function(e){t.$set(t.formItem,"isShow",e)},expression:"formItem.isShow"}},[a("Radio",{attrs:{label:"0"}},[t._v("否")]),t._v(" "),a("Radio",{attrs:{label:"1"}},[t._v("是")])],1)],1),t._v(" "),a("Form-item",[a("Button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.back}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]}},Rvm0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("tucH"),i=a.n(o);e.default={name:"app",components:{MGoodsCategoryForm:i.a},data:function(){return{loadingState:!1}},methods:{changeLoadingState:function(){this.loadingState=!this.loadingState}}}},e3rR:function(t,e,a){var o=a("VU/8")(a("Rvm0"),a("2k71"),null,null);t.exports=o.exports},sgWS:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={create:{api:{path:"/boss/mall/catalog/deprecated-category/create"}},update:{api:{path:"/boss/mall/catalog/deprecated-category/update"}},find:{api:{path:"/boss/mall/catalog/deprecated-category/find",params:{fields:"{cate_id,cate_name,parent_id,icon(w:320,h:320){url,origin},is_show}",goodsCategoryId:0}},responseHandle:function(t){return t.data.app_route="meijiabang://goods_list?category_id="+t.data.cate_id+"&title="+encodeURI(t.data.cate_name),t}},resource:{api:{path:"/boss/mall/catalog/deprecated-category/add-page-info",params:{fields:"{cate_id,cate_name,parent_id,icon(w:320,h:320){url,origin},is_show}",goodsCategoryId:0}},responseHandle:function(t){return t}}};e.default={name:"MGoodsCategoryForm",props:{id:{type:String,default:""},usage:{type:String,default:"edit"}},data:function(){return{formItem:{cateId:0,cateName:"",parentId:0,icon:[],isShow:1},defaultIcon:[],categoryInfo:[],ruleValidate:{cateName:[{required:!0,message:"分类名称不能为空",trigger:"blur"},{type:"string",max:20,message:"分类名称不能超过20字",trigger:"change"}]}}},methods:{syncIcon:function(t){this.formItem.icon=t},back:function(){location.hash="/mall/catalog/deprecated-category/list"},submit:function(){var t=this;this.$refs.formItem.validate(function(e){if(e){if(!t.validateFormData())return;var a=t.getRequestParams(),i=o.create;"edit"===t.usage&&(i=o.update),t.submitRequest(a,i)}else t.$Message.error("表单验证失败!")})},validateFormData:function(){return!0},getIcon:function(){return 0===this.formItem.icon.length?"":this.formItem.icon[0].url},getRequestParams:function(){var t={cate_name:this.formItem.cateName,parent_id:""==this.formItem.parentId?0:this.formItem.parentId,icon:this.getIcon(),is_show:this.formItem.isShow};return"edit"===this.usage&&(t.cate_id=this.formItem.cateId),t},submitRequest:function(t,e){bus.$emit("on-loading");var a=this;this.$Util.api.post(e,t,a).then(function(t){a.$Notice.success({title:"请求成功",desc:""}),a.back()},function(t){bus.$emit("on-loading"),a.$Notice.warning({title:"请求失败",desc:""})})},loadResource:function(){bus.$emit("on-loading");var t=this;this.$Util.api.get(o.resource,t).then(function(e){bus.$emit("on-loading"),t.categoryInfo=e.data.category_info,"edit"===t.usage&&t.$nextTick(function(){t.loadGoodsCategory()})},function(e){bus.$emit("on-loading"),t.$Notice.warning({title:"加载资源失败",desc:""})})},loadGoodsCategory:function(){bus.$emit("on-loading");var t=this;this.$Util.api.get(o.find,t).then(function(e){bus.$emit("on-loading"),t.formItem.cateId=e.data.cate_id,t.formItem.cateName=e.data.cate_name,t.formItem.parentId=e.data.parent_id,t.formItem.icon=[{url:e.data.icon.origin}],t.defaultIcon=[{url:e.data.icon.origin}],t.formItem.appRoute=e.data.app_route,t.formItem.isShow=e.data.is_show},function(e){bus.$emit("on-loading"),t.$Notice.warning({title:"加载详情失败",desc:""})})},initIds:function(){if("edit"===this.usage){var t=this.id;if(!parseInt(t))return alert("goodsCategoryid格式有误"),!1;t=parseInt(t),this.formItem.cateId=t,o.find.api.params.goodsCategoryId=t}}},created:function(){this.initIds(),this.$nextTick(function(){this.loadResource()})}}},tucH:function(t,e,a){var o=a("VU/8")(a("sgWS"),a("HSlv"),null,null);t.exports=o.exports}});