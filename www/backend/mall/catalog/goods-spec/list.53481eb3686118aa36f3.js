webpackJsonp([15],{"/vNP":function(t,e,o){var a=o("j8H6");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("76a9a747",a,!0)},"20yu":function(t,e,o){e=t.exports=o(0)(),e.push([t.i,"",""])},"4+54":function(t,e,o){var a=o("20yu");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("60c9fd06",a,!0)},"6XK6":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o("pb2F");e.default={name:"SetOnSale",props:["spec_id","status"],data:function(){return{}},methods:{setStatus:function(){var t=this;bus.$emit("on-loading"),this.$Util.api.post({api:{path:"/boss/mall/catalog/goods-spec/set-status"}},{spec_id:this.spec_id,status:-1===this.status?1:-1}).then(function(e){0===e.error_code?(t.status=-1===t.status?1:-1,bus.$emit("on-loading")):(bus.$emit("on-loading"),t.$Modal.error({width:240,content:"出错了"}))},function(e){bus.$emit("on-loading"),t.$Modal.error({width:240,content:"出错了"})})}}}},EWRh:function(t,e,o){o("Wr9O");var a=o("VU/8")(o("6XK6"),o("L3Pb"),"data-v-3708f9ee",null);t.exports=a.exports},F9DU:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Tooltip",{attrs:{content:"点击设置库存",placement:"bottom"}},[o("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.showSetStockModal(e)}}},[t._v(t._s(t.stock))]),t._v(" "),o("Modal",{attrs:{title:"修改规格",width:"250",loading:!0,"mask-closable":!1},on:{"on-ok":t.setNewStock},model:{value:t.isSetStockModalShow,callback:function(e){t.isSetStockModalShow=e},expression:"isSetStockModalShow"}},[o("section",[o("p",{staticClass:"modal-tips"},[t._v("SKU条码："+t._s(t.sku))]),t._v(" "),o("label",[o("span",{staticClass:"modal-input-label"},[t._v("库存")]),t._v(" "),o("Input-number",{staticClass:"number-input",attrs:{disabled:!0},model:{value:t.stock,callback:function(e){t.stock=e},expression:"stock"}}),t._v(" "),o("Input",{staticStyle:{width:"150px"},model:{value:t.change_stock,callback:function(e){t.change_stock=e},expression:"change_stock"}},[o("Select",{staticStyle:{width:"70px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:t.update_stock_type,callback:function(e){t.update_stock_type=e},expression:"update_stock_type"}},[o("Option",{attrs:{value:"add"}},[t._v("增加")]),t._v(" "),o("Option",{attrs:{value:"minus"}},[t._v("减少")])],1)],1),t._v(" "),o("span",{staticClass:"input-tips"},[t._v("请填写非负整数")])],1)])])],1)},staticRenderFns:[]}},"FO+c":function(t,e,o){o("wK4q");var a=o("VU/8")(o("SFBL"),o("k4r0"),"data-v-3b474034",null);t.exports=a.exports},KWga:function(t,e,o){var a=o("hUTp");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("5fd6ba40",a,!0)},L3Pb:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return-1===t.status?o("Tooltip",{attrs:{content:"点击上架",placement:"bottom"}},[o("Button",{staticStyle:{color:"red"},attrs:{type:"text",icon:"close-round"},on:{click:t.setStatus}})],1):1===t.status?o("Tooltip",{attrs:{content:"点击下架",placement:"bottom"}},[o("Button",{staticStyle:{color:"green"},attrs:{type:"text",icon:"checkmark-round"},on:{click:t.setStatus}})],1):0===t.status?o("Tooltip",{attrs:{content:"点击恢复为下架状态",placement:"bottom"}},[o("Button",{staticStyle:{"font-size":"16px"},attrs:{type:"text",icon:"trash-a"},on:{click:t.setStatus}})],1):t._e()},staticRenderFns:[]}},LIIM:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("m-page",[o("main",{staticClass:"fixed-width-wrapper"},[o("m-search",{attrs:{"list-info-api":t.listInfoApi,selected:t.selected},on:{"update:listInfoApi":function(e){t.listInfoApi=e},search:t.search,trash:t.trash}}),t._v(" "),o("Card",[o("m-action-bar",[o("Checkbox-group",{on:{"on-change":t.changeTableColumns},model:{value:t.optionalColumnsChecked,callback:function(e){t.optionalColumnsChecked=e},expression:"optionalColumnsChecked"}},[o("span",{staticClass:"text-bold"},[t._v("显示/隐藏")]),t._v(" "),o("Checkbox",{attrs:{label:"origin_price"}},[t._v("原价")]),t._v(" "),o("Checkbox",{attrs:{label:"mall_price"}},[t._v("商场价")]),t._v(" "),o("Checkbox",{attrs:{label:"vip_price"}},[t._v("会员价")])],1)],1),t._v(" "),o("Table",{attrs:{border:"",columns:t.actualColumns,data:t.data},on:{"on-selection-change":t.select}}),t._v(" "),o("div",{staticClass:"page-bar"},[o("Page",{attrs:{current:t.page.currentPage,"page-size":t.page.pageSize,total:t.page.total,size:"small"},on:{"on-change":t.changePage}})],1)],1),t._v(" "),o("Back-top",{attrs:{bottom:80,right:30}},[o("div",{staticClass:"top"},[t._v("返回顶端")])])],1)])},staticRenderFns:[]}},M0B8:function(t,e,o){o("KWga");var a=o("VU/8")(o("lsFa"),o("LIIM"),"data-v-a70e389a",null);t.exports=a.exports},P0tr:function(t,e,o){o("/vNP");var a=o("VU/8")(o("ZeT6"),o("F9DU"),"data-v-b76fbac6",null);t.exports=a.exports},SFBL:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o("pb2F");e.default={name:"search",props:["listInfoApi","selected"],data:function(){return{confirmCreate:!1,search:{status:1,spec_id:"",goods_id:"",goods_name:"",sku:"",color_tag_id:null,operator:null},statusOptions:[{value:1,label:"上架"},{value:-1,label:"下架"},{value:0,label:"废弃"}],colorTagOptions:[],operatorOptions:[]}},methods:{doSearch:function(){this.buildSearch(),this.$emit("search")},exportExcel:function(){this.buildSearch();var t=this.listInfoApi.params,e="";for(var o in t)null!==t[o]&&(e+=o+"="+t[o]+"&");window.open("/boss/mall/catalog/goods-spec/export-excel?"+e)},buildSearch:function(){var t={},e=this.search;switch(e.status){case 1:t.status=1;break;case 0:t.status=0;break;case-1:t.status=-1;break;default:t.status=1}t.goods_id=e.goods_id,t.spec_id=e.spec_id,t.sku=e.sku,t.goods_name=e.goods_name,t.color_tag_id=e.color_tag_id,this.listInfoApi.params.offset=0,Object.assign(this.listInfoApi.params,t)},trash:function(){var t=this;if(this.selected.length>0){var e=this;this.$Modal.confirm({width:240,closable:!0,maskClosable:!1,loading:!0,content:"将对"+this.selected.length+'个规格标记为"废弃"',onOk:function(){var t=this;this.$Util.api.post({api:{path:"/boss/mall/catalog/goods-spec/batch-delete"}},{spec_id:e.selected}).then(function(o){0===o.error_code?(e.$emit("trash"),t.$Modal.remove(),setTimeout(function(){t.$Modal.success({width:240,content:"已将"+e.selected.length+'个规格标记为"废弃"'})},500),setTimeout(function(){t.$Modal.remove()},5e3)):(t.$Modal.remove(),t.$Modal.error({width:240,content:"出错了"}))},function(e){t.$Modal.remove(),t.$Modal.error({width:240,content:"出错了"})})}})}else this.$Modal.warning({width:240,content:"请先勾选要废弃的Spec_ID"}),setTimeout(function(){t.$Modal.remove()},5e3)},create:function(){this.search.goods_id?(this.confirmCreate=!1,location.hash="/mall/catalog/goods-spec/add?goods_id="+this.search.goods_id):this.confirmCreate=!0},loadColorTags:function(){var t=this;this.$Util.api.get({api:{path:"/boss/mall/catalog/goods-spec/color-tag",params:{fields:"{id,name}"}}}).then(function(e){return t.colorTagOptions=e.data},function(e){return t.colorTagOptions=[]})},loadOperators:function(){}},created:function(){var t=this;this.$nextTick(function(){t.listInfoApi.params.goods_id&&0!==t.listInfoApi.params.goods_id&&(t.search.goods_id=t.listInfoApi.params.goods_id),t.loadColorTags()})}}},Wr9O:function(t,e,o){var a=o("v5f+");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("619940ae",a,!0)},X6uq:function(t,e,o){e=t.exports=o(0)(),e.push([t.i,".search-card[data-v-3b474034]{margin-bottom:10px}.export-btn[data-v-3b474034]{color:#2d8cf0;border-color:#2d8cf0}.delete-btn[data-v-3b474034]{color:#ed3f14;border-color:#ed3f14}.modal-tips[data-v-3b474034]{color:#888;font-size:13px;margin-bottom:10px}.modal-input-label[data-v-3b474034]{font-weight:700;font-size:14px;margin-right:10px}.number-input[data-v-3b474034]{width:120px}",""])},ZeT6:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o("pb2F");e.default={name:"SetStock",props:["spec_id","sku","stock"],data:function(){return{isSetStockModalShow:!1,oldStock:0,change_stock:0,update_stock_type:"add"}},methods:{showSetStockModal:function(){this.isSetStockModalShow=!0},setNewStock:function(){var t=this;if("minus"===this.update_stock_type&&this.change_stock>this.stock)return void this.$Modal.error({width:240,content:"出错了，设置库存失败"});this.$Util.api.post({api:{path:"/boss/mall/catalog/goods-spec/set-stock"}},{spec_id:this.spec_id,change_stock:this.change_stock,update_stock_type:this.update_stock_type}).then(function(e){0===e.error_code?(t.isSetStockModalShow=!1,"add"===t.update_stock_type?t.oldStock=parseInt(t.stock)+parseInt(t.change_stock):"minus"===t.update_stock_type&&(t.oldStock=parseInt(t.stock)-parseInt(t.change_stock)),t.stock=t.oldStock):(t.stock=t.oldStock,t.isSetStockModalShow=!1,t.$Modal.error({width:240,content:"出错了，设置库存失败"}))},function(e){t.stock=t.oldStock,t.isSetStockModalShow=!1,t.$Modal.error({width:240,content:"出错了，设置库存失败"})})}},mounted:function(){this.oldStock=this.stock}}},hUTp:function(t,e,o){e=t.exports=o(0)(),e.push([t.i,".top[data-v-a70e389a]{padding:10px;background:rgba(0,153,229,.7);color:#fff;text-align:center;border-radius:2px}.m-action-bar[data-v-a70e389a]{margin-bottom:15px}.text-bold[data-v-a70e389a]{margin-right:10px;line-height:14px;font-size:14px;font-weight:700}.page-bar[data-v-a70e389a]{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;margin:15px auto 0}",""])},j8H6:function(t,e,o){e=t.exports=o(0)(),e.push([t.i,".modal-tips[data-v-b76fbac6]{color:#888;font-size:13px;margin-bottom:10px}.modal-input-label[data-v-b76fbac6]{font-weight:700;font-size:14px;margin-right:5px}.number-input[data-v-b76fbac6]{width:80px}.input-tips[data-v-b76fbac6]{color:#aaa;font-size:12px;margin-left:5px}",""])},k4r0:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Card",{staticClass:"search-card"},[o("Form",{attrs:{model:t.search}},[o("Row",[o("Col",{attrs:{span:"3"}},[o("Form-item",{attrs:{label:"状态","label-position":"left","label-width":36}},[o("Select",{attrs:{placeholder:"请选择"},model:{value:t.search.status,callback:function(e){t.$set(t.search,"status",e)},expression:"search.status"}},t._l(t.statusOptions,function(e){return o("Option",{attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)],1),t._v(" "),o("Col",{attrs:{span:"6"}},[o("Form-item",{attrs:{label:"Goods_ID","label-position":"left","label-width":80}},[o("Input",{attrs:{placeholder:"多个id用逗号隔开"},on:{"on-enter":t.doSearch},model:{value:t.search.goods_id,callback:function(e){t.$set(t.search,"goods_id",e)},expression:"search.goods_id"}})],1)],1),t._v(" "),o("Col",{attrs:{span:"7"}},[o("Form-item",{attrs:{label:"Spec_ID","label-position":"left","label-width":75}},[o("Input",{attrs:{placeholder:"多个id用逗号隔开"},on:{"on-enter":t.doSearch},model:{value:t.search.spec_id,callback:function(e){t.$set(t.search,"spec_id",e)},expression:"search.spec_id"}})],1)],1),t._v(" "),o("Col",{attrs:{span:"7"}},[o("Form-item",{attrs:{label:"SKU条码","label-position":"left","label-width":75}},[o("Input",{attrs:{placeholder:"多个条码用逗号隔开"},on:{"on-enter":t.doSearch},model:{value:t.search.sku,callback:function(e){t.$set(t.search,"sku",e)},expression:"search.sku"}})],1)],1)],1),t._v(" "),o("br"),t._v(" "),o("Row",[o("Col",{attrs:{span:"9"}},[o("Form-item",{attrs:{label:"商品名称","label-position":"left","label-width":60}},[o("Input",{attrs:{placeholder:"多个搜索词逗号隔开"},on:{"on-enter":t.doSearch},model:{value:t.search.goods_name,callback:function(e){t.$set(t.search,"goods_name",e)},expression:"search.goods_name"}})],1)],1),t._v(" "),o("Col",{attrs:{span:"5"}},[o("Form-item",{attrs:{label:"颜色标签","label-width":75}},[o("Select",{attrs:{filterable:"",placeholder:"搜索颜色标签"},model:{value:t.search.color_tag_id,callback:function(e){t.$set(t.search,"color_tag_id",e)},expression:"search.color_tag_id"}},t._l(t.colorTagOptions,function(e){return o("Option",{attrs:{value:e.id}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),o("Col",{attrs:{span:"5"}},[o("Form-item",{attrs:{label:"运营","label-width":50}},[o("Select",{attrs:{filterable:"",placeholder:"搜索Boss账号"},model:{value:t.search.operator,callback:function(e){t.$set(t.search,"operator",e)},expression:"search.operator"}},t._l(t.operatorOptions,function(e){return o("Option",{attrs:{value:e.uid}},[t._v(t._s(e.name))])}))],1)],1)],1),t._v(" "),o("br"),t._v(" "),o("Row",[o("Col",{attrs:{span:"2"}},[o("Form-item",[o("Button",{attrs:{type:"primary",long:""},on:{click:t.doSearch}},[t._v("搜索")])],1)],1),t._v(" "),o("Col",{attrs:{span:"2"}},[o("Form-item",[o("Button",{staticClass:"export-btn",attrs:{type:"ghost",long:""},on:{click:t.exportExcel}},[t._v("导出")])],1)],1),t._v(" "),o("Col",{attrs:{span:"2"}},[o("Form-item",[o("Button",{staticClass:"delete-btn",attrs:{type:"ghost",long:""},on:{click:t.trash}},[t._v("废弃")])],1)],1),t._v(" "),o("Col",{attrs:{span:"2",offset:"15"}},[o("Form-item",[o("Button",{attrs:{type:"primary",long:""},on:{click:t.create}},[t._v("新建")])],1)],1)],1)],1),t._v(" "),o("Modal",{attrs:{title:"新建规格",width:"240","mask-closable":!1},on:{"on-ok":t.create},model:{value:t.confirmCreate,callback:function(e){t.confirmCreate=e},expression:"confirmCreate"}},[o("section",[o("p",{staticClass:"modal-tips"},[t._v("请说明要对哪个商品添加规格")]),t._v(" "),o("label",[o("span",{staticClass:"modal-input-label"},[t._v("Goods_ID")]),t._v(" "),o("Input-number",{staticClass:"number-input",attrs:{min:1},model:{value:t.search.goods_id,callback:function(e){t.$set(t.search,"goods_id",e)},expression:"search.goods_id"}})],1)])])],1)},staticRenderFns:[]}},kubL:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Poptip",{attrs:{title:"",content:t.fullText,placement:t.placement}},[o("span",[t._v(t._s(t.ellipsisText))]),t._v(" "),o("Icon",{attrs:{type:"help-circled"}})],1)},staticRenderFns:[]}},lsFa:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=o("FO+c"),s=o.n(a),n=o("EWRh"),i=o.n(n),r=o("P0tr"),c=o.n(r),l=o("ozpg"),d=o.n(l);e.default={name:"app",components:{"m-search":s.a},data:function(){return{columns:["checkbox","status","spec_id","goods_id","spec_name","goods_name","sku","stock","category","color_tag","origin_price","mall_price","vip_price","operate"],optionalColumns:["origin_price","mall_price","vip_price"],optionalColumnsChecked:[],actualColumns:[],data:[],listInfoApi:{path:"/boss/mall/catalog/goods-spec/find-list",params:{offset:0,limit:24,fields:"{id,goods_id,status,delete_time,sku,stock,spec_1,spec_2,spec_3,spec_4,spec_5,goods{goods_name,spec_name_1,spec_name_2,spec_name_3,spec_name_4,spec_name_5,mall_price,original_price,price_grade},category{name},color_tag{name},goods_name{goods_id}}"}},pageInfoApi:{path:"/boss/mall/catalog/goods-spec/list-page-info"},page:{total:0,pageSize:24,currentPage:1},selected:[]}},created:function(){var t=this;this.$nextTick(function(){bus.$emit("on-loading"),t.$route.query.goods_id&&(t.listInfoApi.params.goods_id=t.$route.query.goods_id),t.loadListData(),t.loadPageData()})},mounted:function(){this.changeTableColumns()},methods:{loadListData:function(){var t=this;this.$Util.api.get({api:this.listInfoApi},this).then(function(e){bus.$emit("on-loading"),0===e.error_code?t.data=e.data:20101===e.error_code?t.data=[]:t.$Modal.error({width:300,title:"错误提示",content:e.error_description?e.error_description:e.error_message})},function(e){bus.$emit("on-loading"),t.$Modal.error({width:300,title:"错误提示",content:e.message?e.message:"发生了未知错误，请联系开发人员！"})})},loadPageData:function(){var t=this;this.page.total=0,this.page.currentPage=1,this.pageInfoApi.params=this.listInfoApi.params,this.$Util.api.get({api:this.pageInfoApi},this).then(function(e){0===e.error_code?t.page.total=e.data.total:(t.enableLoadMore=!0,t.$Modal.error({width:300,title:"错误提示",content:e.error_description?e.error_description:e.error_message}))},function(e){t.$Modal.error({width:300,title:"错误提示",content:e.message?e.message:"发生了未知错误，请联系开发人员！"})})},changeTableColumns:function(){var t=this,e={checkbox:{type:"selection",width:60,align:"center"},status:{title:"状态",key:"status",width:80,align:"center",render:function(t,e){return t(i.a,{props:{spec_id:e.row.id,status:e.row.status}})}},spec_id:{title:"Spec_ID",key:"id",sortable:!0,width:110,align:"center"},goods_id:{title:"Goods_ID",key:"goods_id",sortable:!0,width:110,align:"center"},spec_name:{title:"规格名称",key:"spec_name",align:"center",render:function(t,e){for(var o=[],a=1;a<6;a++)e.row.goods["spec_name_"+a]&&o.push(t("p",{},[e.row.goods["spec_name_"+a]+"："+e.row["spec_"+a]]));return t("section",{style:{textAlign:"left"}},o)}},goods_name:{title:"商品名称",key:"goods_name",width:200,align:"center",render:function(t,e){return e.row.goods.goods_name.length>25?t(d.a,{props:{fullText:e.row.goods.goods_name,length:25,placement:"bottom-end"}}):t("span",{},[e.row.goods.goods_name])}},sku:{title:"SKU条码",key:"sku",width:110,align:"center"},stock:{title:"库存",key:"stock",sortable:!0,width:80,align:"center",render:function(t,e){return t(c.a,{props:{spec_id:e.row.id,sku:e.row.sku,stock:e.row.stock}})}},category:{title:"规格分类",key:"category",width:100,align:"center",render:function(t,e){return t("span",{},[e.row.category.name])}},color_tag:{title:"颜色标签",key:"color_tag",width:80,align:"center",render:function(t,e){if(null!==e.row.color_tag&&e.row.color_tag.name)return t("span",{},[e.row.color_tag.name])}},origin_price:{title:"原价",key:"original_price",sortable:!0,align:"center",width:80,render:function(t,e){return t("span",{},[e.row.goods.original_price])}},mall_price:{title:"商城价",key:"mall_price",sortable:!0,align:"center",width:80,render:function(t,e){return t("span",{},[e.row.goods.mall_price])}},vip_price:{title:"会员价",key:"vip_price",align:"center",width:100,render:function(t,e){if(e.row.goods.price_grade){var o=JSON.parse(e.row.goods.price_grade);return t("section",{style:{textAlign:"left"}},[t("p",{},["银牌："+o[10]]),t("p",{},["金牌："+o[20]]),t("p",{},["白金："+o[30]])])}}},operate:{title:"操作",key:"action",align:"center",width:80,render:function(t,e){return t("a",{attrs:{href:"/backend/#/mall/catalog/goods-spec/edit/"+e.row.id+"?goods_id="+e.row.goods_id}},["编辑"])}}},o=[];this.columns.forEach(function(a){var s=!0;t.optionalColumns.forEach(function(e){e===a&&(s=!1,t.optionalColumnsChecked.forEach(function(t){t===e&&(s=!0)}))}),s&&o.push(e[a])}),this.actualColumns=o},search:function(){this.data=[],bus.$emit("on-loading"),this.loadListData(),this.loadPageData()},trash:function(){for(var t=0;t<this.data.length;t++)for(var e=0;e<this.selected.length;e++)if(this.data[t].id===this.selected[e]){this.data[t].status=0;break}},select:function(t){var e=this;this.selected=[],t.length>0&&t.forEach(function(t){return e.selected.push(t.id)})},changePage:function(t){bus.$emit("on-loading"),this.page.currentPage=t,this.listInfoApi.params.offset=(t-1)*this.listInfoApi.params.limit,this.loadListData()}}}},ozpg:function(t,e,o){o("4+54");var a=o("VU/8")(o("poi3"),o("kubL"),"data-v-86a4d12e",null);t.exports=a.exports},poi3:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"Ellipsis",props:{fullText:{type:String},length:{type:Number},placement:{type:String}},data:function(){return{}},computed:{ellipsisText:function(){return this.fullText.substr(0,this.length)+"..."}}}},"v5f+":function(t,e,o){e=t.exports=o(0)(),e.push([t.i,"",""])},wK4q:function(t,e,o){var a=o("X6uq");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("14de89c4",a,!0)}});