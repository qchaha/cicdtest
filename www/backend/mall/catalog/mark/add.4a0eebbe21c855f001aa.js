webpackJsonp([112],{"7Y7P":function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("m-page-edit",[a("m-mark-form",{attrs:{usage:"add"}})],1)},staticRenderFns:[]}},DEFA:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={create:{api:{path:"/boss/mall/catalog/mark/create"}},update:{api:{path:"/boss/mall/catalog/mark/update"}},find:{api:{path:"/boss/mall/catalog/mark/find",params:{fields:"{id,name,image(w:80,h:80){url,origin}}",id:0}}}};e.default={name:"MMarkForm",props:{id:{type:String,default:""},usage:{type:String,default:"edit"}},data:function(){return{formItem:{id:0,name:"",defaultImages:[],image:""},ruleValidate:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}]}}},methods:{syncImage:function(t){this.formItem.image=t},back:function(){location.hash="/mall/catalog/mark/list"},submit:function(t){var e=this;this.$refs[t].validate(function(t){if(t&&e.validateFormData()){var a=e.getRequestParams();e.submitRequest(a)}else e.$Message.error("表单验证失败!")})},validateFormData:function(){return 0!==this.formItem.image.length||(this.$Notice.warning({title:"必须上传图标",desc:""}),!1)},getRequestParams:function(){var t={name:this.formItem.name,image:""};return this.formItem.image.map(function(e){""!==e.url&&(t.image=e.url)}),"edit"===this.usage&&(t.id=this.formItem.id),t},submitRequest:function(t){bus.$emit("on-loading");var e=this,a=i.create;"edit"===this.usage&&(a=i.update),this.$Util.api.post(a,t,e).then(function(){e.$Message.success("保存成功"),e.back()},function(){bus.$emit("on-loading"),e.$Message.warning("请求失败")})},loadMark:function(){bus.$emit("on-loading");var t=this;this.$Util.api.get(i.find,t).then(function(e){bus.$emit("on-loading"),t.formItem.name=e.data.name,t.formItem.image=[{url:e.data.image.origin}],t.formItem.defaultImages=[{url:e.data.image.origin}]},function(e){bus.$emit("on-loading"),t.$Message.warning("加载详情失败")})}},created:function(){var t=this.id;if(!parseInt(t)&&"edit"===this.usage)return alert("id格式有误"),!1;t=parseInt(t),this.formItem.id=t,i.find.api.params.id=t,"edit"===this.usage&&this.$nextTick(function(){this.loadMark()})}}},Z4fF:function(t,e,a){var i=a("VU/8")(a("nPo0"),a("7Y7P"),null,null);t.exports=i.exports},"lgX/":function(t,e,a){var i=a("VU/8")(a("DEFA"),a("uO1a"),null,null);t.exports=i.exports},nPo0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("lgX/"),n=a.n(i);e.default={name:"app",components:{MMarkForm:n.a},data:function(){return{}}}},uO1a:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"padding-top":"20px"}},[a("Form",{ref:"formItem",attrs:{model:t.formItem,"label-width":120,rules:t.ruleValidate}},[a("div",{staticStyle:{"margin-bottom":"30px"}},[a("Form-item",{attrs:{label:"角标名称",prop:"name"}},[a("i-input",{staticStyle:{width:"300px"},attrs:{maxlength:100,placeholder:"角标名称"},model:{value:t.formItem.name,callback:function(e){t.$set(t.formItem,"name",e)},expression:"formItem.name"}})],1)],1),t._v(" "),a("Form-item",{attrs:{required:"",label:"图 标"}},[a("m-upload-image",{attrs:{"default-images":t.formItem.defaultImages},on:{"on-success":t.syncImage}})],1),t._v(" "),a("Form-item",[a("i-button",{attrs:{type:"primary"},on:{click:function(e){t.submit("formItem")}}},[t._v("提交")]),t._v(" "),a("i-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.back}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]}}});