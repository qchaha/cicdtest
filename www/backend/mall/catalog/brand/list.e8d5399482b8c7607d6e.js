webpackJsonp([29],{"3PV6":function(t,a){t.exports={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Card",[e("Form",{attrs:{model:t.searchParams}},[e("Row",[e("Col",{attrs:{span:"5"}},[e("FormItem",{attrs:{label:"品牌","label-width":40}},[e("Select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:t.searchParams.id,callback:function(a){t.$set(t.searchParams,"id",a)},expression:"searchParams.id"}},t._l(t.brandOptions,function(a){return e("Option",{attrs:{value:a.id}},[t._v(t._s(a.name))])}))],1)],1),t._v(" "),e("Col",{attrs:{span:"3"}},[e("FormItem",{attrs:{label:"状态","label-width":50}},[e("Select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.searchParams.status,callback:function(a){t.$set(t.searchParams,"status",a)},expression:"searchParams.status"}},t._l(t.statusOptions,function(a){return e("Option",{attrs:{value:a.value}},[t._v(t._s(a.label))])}))],1)],1)],1),t._v(" "),e("Row",[e("Col",{attrs:{span:"2"}},[e("Button",{attrs:{type:"primary",long:""},on:{click:t.onSearch}},[t._v("搜索")])],1),t._v(" "),e("Col",{attrs:{span:"2",push:"19"}},[e("Button",{attrs:{type:"primary",long:""},on:{click:t.toCreate}},[t._v("新建")])],1)],1)],1)],1)},staticRenderFns:[]}},"5KMU":function(t,a,e){a=t.exports=e(0)(),a.push([t.i,".page-bar[data-v-379c15bd]{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;margin:15px auto 0}",""])},"7hpV":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=e("9/f7"),i=e.n(r),n=e("sWtP"),o=e.n(n);a.default={name:"List",components:{MSearch:i.a,MTable:o.a},data:function(){return{listApi:{api:{path:"/boss/mall/catalog/brand/find-list",params:{offset:0,limit:24,id:null,status:1,fields:"{id,name,status,show,sort,relative_brands{similar_value,brand_name},image{origin,url},create_time,update_time,operator{admin_name}}"}}},pageApi:{api:{path:"/boss/mall/catalog/brand/list-page-info"}},optionsApi:{api:{path:"/boss/mall/catalog/brand/find-list",params:{offset:0,limit:1e3,fields:"{id,name}"}}},loadTotal:3,loadedNum:0,brandOptions:[],data:[],page:{total:0,pageSize:24,currentPage:1}}},created:function(){var t=this;this.$nextTick(function(){bus.$emit("on-loading"),t.loadList(),t.loadPage(),t.loadOptions(),bus.$on("alert-error-tips",function(a,e){return t.alertErrorTips(a,e)}),bus.$on("on-search",function(){return t.doSearch()}),bus.$on("change-page",function(a){return t.changePage(a)})})},watch:{loadedNum:function(){this.loadedNum>=this.loadTotal&&(bus.$emit("on-loading"),this.loadedNum=0)}},methods:{loadList:function(){var t=this;this.$Util.api.get(this.listApi,this).then(function(a){t.loadedNum+=1,t.data=a.data},function(a){t.loadedNum+=1,t.alertErrorTips(a.message?a.message:"发生了未知的错误",300)})},loadPage:function(){this.page.total=0,this.page.currentPage=1,this.pageApi.api.params=this.listApi.api.params;var t=this;this.$Util.api.get(this.pageApi,this).then(function(a){t.loadedNum+=1,t.page.total=a.data.total},function(a){t.loadedNum+=1,t.alertErrorTips(a.message?a.message:"发生了未知的错误",300)})},loadOptions:function(){var t=this;this.$Util.api.get(this.optionsApi,this).then(function(a){t.loadedNum+=1,t.brandOptions=a.data},function(a){t.loadedNum+=1,t.alertErrorTips(a.message?a.message:"发生了未知的错误",300)})},doSearch:function(){this.data=[],this.loadTotal=2,bus.$emit("on-loading"),this.loadList(),this.loadPage()},changePage:function(t){this.page.currentPage=t,this.listApi.api.params.offset=(t-1)*this.listApi.api.params.limit,this.loadTotal=1,bus.$emit("on-loading"),this.loadList()},alertErrorTips:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;this.$Modal.error({width:a,content:t})}},beforeDestroy:function(){bus.$off("alert-error-tips"),bus.$off("on-search"),bus.$off("change-page")}}},"9/f7":function(t,a,e){e("GC/t");var r=e("VU/8")(e("LKit"),e("3PV6"),"data-v-244bde6e",null);t.exports=r.exports},"GC/t":function(t,a,e){var r=e("v61y");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);e("rjj0")("284477d6",r,!0)},LKit:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default={name:"MSearch",props:{searchParams:{type:Object,default:function(){return{id:null,status:1}}},brandOptions:{type:Array,default:function(){return[]}}},data:function(){return{statusOptions:[{label:"已废弃",value:0},{label:"使用中",value:1}]}},methods:{toCreate:function(){location.hash="/mall/catalog/brand/add"},onSearch:function(){bus.$emit("on-search")}}}},O1eP:function(t,a,e){a=t.exports=e(0)(),a.push([t.i,".ivu-card[data-v-a8728844]{margin-bottom:15px}.top[data-v-a8728844]{padding:10px;background:rgba(0,153,229,.7);color:#fff;text-align:center;border-radius:2px}",""])},TFdo:function(t,a,e){var r=e("O1eP");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);e("rjj0")("6d348bf4",r,!0)},UaPv:function(t,a,e){var r=e("5KMU");"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);e("rjj0")("1c01c1f5",r,!0)},cuGD:function(t,a,e){e("TFdo");var r=e("VU/8")(e("7hpV"),e("qq8t"),"data-v-a8728844",null);t.exports=r.exports},iSQY:function(t,a){t.exports={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("Card",[e("Table",{attrs:{border:"",columns:t.columns,data:t.data}}),t._v(" "),e("div",{staticClass:"page-bar"},[e("Page",{attrs:{current:t.page.currentPage,"page-size":t.page.pageSize,total:t.page.total,size:"small"},on:{"on-change":t.changePage}})],1)],1)},staticRenderFns:[]}},m5rm:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default={name:"MTable",props:{data:{type:Array,default:function(){return[]}},page:{type:Object,default:function(){return{total:0,pageSize:24,currentPage:1}}}},data:function(){var t=this;return{discardApi:{api:{path:"/boss/mall/catalog/brand/discard"}},restoreApi:{api:{path:"/boss/mall/catalog/brand/restore"}},columns:[{title:"ID",key:"id",align:"center",sortable:!0,width:80},{title:"品牌",key:"name",align:"center"},{title:"LOGO",key:"image",align:"center",width:100,render:function(t,a){return a.row.image.origin&&a.row.image.url?t("div",{style:{height:"60px",width:"60px",border:"1px solid transparent",borderRadius:"4px",background:"#fff",boxShadow:"0 1px 1px rgba(0,0,0,.2)"}},[t("img",{attrs:{src:a.row.image.url},style:{width:"100%",height:"100%"}})]):t("span",{},"未上传")}},{title:"排序值",key:"sort",align:"center",width:100},{title:"相关品牌",key:"relative_brands",align:"center",width:200,render:function(t,a){var e="";a.row.relative_brands.length>5&&(a.row.relative_brands.length=5);for(var r=0;r<a.row.relative_brands.length;r++)e+=a.row.relative_brands[r].similar_value.toFixed(2)+a.row.relative_brands[r].brand_name+";";return t("p",{},e)}},{title:"创建时间",key:"create_time",align:"center",sortable:!0,width:120,render:function(a,e){var r=parseInt(e.row.create_time);return a("div",{},[a("p",{},t.$Util.dateFormat(r,"yyyy-MM-dd")),a("p",{},t.$Util.dateFormat(r,"hh:mm:ss"))])}},{title:"更新时间",key:"update_time",align:"center",sortable:!0,width:120,render:function(a,e){var r=parseInt(e.row.update_time);return a("div",{},[a("p",{},t.$Util.dateFormat(r,"yyyy-MM-dd")),a("p",{},t.$Util.dateFormat(r,"hh:mm:ss"))])}},{title:"显示品牌入口",key:"show",align:"center",width:120,render:function(t,a){if(1==a.row.show)return t("Tag",{attrs:{color:"green"}},"显示")}},{title:"状态",key:"state",align:"center",width:100,render:function(t,a){switch(a.row.status){case 0:return t("Tag",{attrs:{color:"red"}},"已作废");case 1:return t("Tag",{attrs:{color:"green"}},"使用中")}}},{title:"操作",key:"action",align:"center",width:100,render:function(a,e){var r=[a("Button",{attrs:{type:"text",size:"small"},style:{color:"#3366FF"},on:{click:function(){location.hash="/mall/catalog/brand/edit/"+e.row.id}}},"编辑"),a("Button",{attrs:{type:"text",size:"small"},style:{color:"#3366FF"},on:{click:function(){location.hash="/mall/catalog/brand/similarList/"+e.row.id}}},"查看相关品牌")];return 0!==e.row.status?r.push(a("Button",{attrs:{type:"text",size:"small"},style:{color:"#FF0000"},on:{click:function(){var a=t;a.$Modal.confirm({width:300,loading:!0,content:"确认废弃ID【"+e.row.id+"】的品牌么？",onOk:function(){t.$Util.api.post(t.discardApi,{id:e.row.id},a).then(function(t){0===t.error_code?(e.row.status=0,a.$Modal.remove(),setTimeout(function(){a.$Modal.success({width:250,loading:!1,content:"已成功作废"})},300)):(a.$Modal.remove(),setTimeout(function(){bus.$emit("alert-error-tips",t.error_description?t.error_description:"发生了未知的错误",300)},300))},function(t){a.$Modal.remove(),setTimeout(function(){bus.$emit("alert-error-tips",t.message?t.message:"发生了未知的错误",300)},300)})}})}}},"废弃")):r.push(a("Button",{attrs:{type:"text",size:"small"},style:{color:"#00cc66"},on:{click:function(){bus.$emit("on-loading"),t.$Util.api.post(t.restoreApi,{id:e.row.id},t).then(function(t){bus.$emit("on-loading"),0===t.error_code?e.row.status=1:bus.$emit("alert-error-tips",t.error_description?t.error_description:"发生了未知的错误",300)},function(t){bus.$emit("on-loading"),bus.$emit("alert-error-tips",t.message?t.message:"发生了未知的错误",300)})}}},"恢复")),a("div",{},r)}}]}},methods:{changePage:function(t){bus.$emit("change-page",t)}}}},qq8t:function(t,a){t.exports={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("m-page",[e("m-search",{attrs:{brandOptions:t.brandOptions,searchParams:t.listApi.api.params},on:{"update:searchParams":function(a){t.$set(t.listApi.api,"params",a)}}}),t._v(" "),e("m-table",{attrs:{data:t.data,page:t.page}}),t._v(" "),e("Back-top",{attrs:{bottom:100,right:30}},[e("div",{staticClass:"top"},[t._v("返回顶端")])])],1)},staticRenderFns:[]}},sWtP:function(t,a,e){e("UaPv");var r=e("VU/8")(e("m5rm"),e("iSQY"),"data-v-379c15bd",null);t.exports=r.exports},v61y:function(t,a,e){a=t.exports=e(0)(),a.push([t.i,".ivu-form>.ivu-row[data-v-244bde6e]:not(:last-child){margin-bottom:10px}",""])}});