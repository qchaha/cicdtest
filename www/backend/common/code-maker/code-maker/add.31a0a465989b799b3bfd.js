webpackJsonp([74],{"1woX":function(e,t,o){o("T373");var i=o("VU/8")(o("de10"),o("Hnpd"),"data-v-a42c1178",null);e.exports=i.exports},"5FOW":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("m-page-edit",{attrs:{"is-loading":e.loadingState}},[o("m-code-maker-form",{attrs:{usage:"add"},on:{loading:e.changeLoadingState}})],1)},staticRenderFns:[]}},HJeG:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("1woX"),s=o.n(i);t.default={name:"app",components:{MCodeMakerForm:s.a},data:function(){return{loadingState:!1}},methods:{changeLoadingState:function(){this.loadingState=!this.loadingState}}}},Hnpd:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{"padding-top":"20px"}},[o("Form",{attrs:{"label-width":60}},[o("Form-item",{attrs:{label:"模块"}},[o("Select",{model:{value:e.selectedModule,callback:function(t){e.selectedModule=t},expression:"selectedModule"}},[o("Option",{attrs:{value:"__newModule"}},[e._v("新模块")]),e._v(" "),e._l(e.existModules,function(t){return o("Option",{key:t.module,attrs:{value:t.module}},[e._v("\n                    "+e._s(t.module)+"\n                ")])})],2)],1),e._v(" "),o("Form-item",{class:{hidden:"__newModule"!==e.selectedModule},attrs:{label:"新模块"}},[o("Input",{attrs:{placeholder:"输入新模块名"},model:{value:e.newModule,callback:function(t){e.newModule=t},expression:"newModule"}})],1),e._v(" "),o("Form-item",{attrs:{label:"应用"}},[o("Input",{attrs:{placeholder:"输入应用名"},on:{"on-blur":e.handleSubModuleInputBlur},model:{value:e.subModule,callback:function(t){e.subModule=t},expression:"subModule"}})],1),e._v(" "),o("Form-item",{attrs:{label:"Model名"}},[o("Rol",[o("Col",{attrs:{span:"24"}},e._l(e.models,function(t){return o("Tag",{attrs:{closable:e.models.length>1},on:{"on-close":function(o){e.handleModelTagClose(t)}}},[e._v(e._s(t))])}))],1),e._v(" "),o("Rol",[o("Col",{attrs:{span:"24"}},[o("Input",{attrs:{size:"small"},model:{value:e.inputModel,callback:function(t){e.inputModel=t},expression:"inputModel"}}),e._v(" "),o("Button",{attrs:{icon:"ios-plus-empty",type:"dashed",size:"small"},on:{click:function(t){e.addModel(e.inputModel)}}},[e._v("添加Model")])],1)],1)],1),e._v(" "),o("Form-item",[o("i-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]}},MIpc:function(e,t,o){t=e.exports=o(0)(),t.push([e.i,".hidden[data-v-a42c1178]{display:none}",""])},T373:function(e,t,o){var i=o("MIpc");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);o("rjj0")("38253514",i,!0)},de10:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={create:{api:{path:"/v3/make_code/make"}},resource:{api:{path:"/v3/make_code/add-page-info",params:{}},responseHandle:function(e){return e}}};t.default={name:"MCodeMakerForm",data:function(){return{selectedModule:"",subModule:"",inputModel:"",newModule:"",models:[],existModules:[],tableColumns:[],tableData:[]}},computed:{selectedSubModules:function(){for(var e in this.existModules)if(this.existModules[e].module===this.selectedModule)return this.existModules[e].subModules;return[]},subModuleExist:function(){return-1!==this.selectedSubModules.indexOf(this.subModule)}},methods:{checkSubModuleExist:function(){return this.subModuleExist},handleSubModuleInputBlur:function(){if(this.checkSubModuleExist())return this.subModuleExist&&this.$Notice.error({title:"子模块 "+this.subModule+" 已经存在"}),void(this.models=[]);this.initModel()},initModel:function(){this.models=[],this.models.push(this.subModule)},addModel:function(e){this.models.push(e)},handleModelTagClose:function(e){var t=this.models.indexOf(e);this.models.splice(t,1)},ucfirst:function(e){return e.slice(0,1).toUpperCase()+e.slice(1,e.length)},submit:function(){if(this.validateFormData()){var e=this.getRequestParams(),t=i.create;this.submitRequest(e,t)}},validateFormData:function(){return"__newModule"===this.selectedModule&&""===this.newModule?(this.$Notice.error({title:"请先输入新模块"}),!1):""===this.selectedModule||""===this.subModule?(this.$Notice.error({title:"请先选择模块和输入应用名"}),!1):!this.checkSubModuleExist()||(this.subModuleExist&&this.$Notice.error({title:"子模块 "+this.subModule+" 已经存在"}),!1)},getRequestParams:function(){return{module:"__newModule"===this.selectedModule?this.newModule:this.selectedModule,subModule:this.subModule,models:this.models}},submitRequest:function(e,t){bus.$emit("on-loading");var o=this;this.$Util.api.post(t,e,o).then(function(e){o.$Notice.success({title:"生成成功",desc:""}),window.location.reload()},function(e){bus.$emit("on-loading"),o.$Notice.warning({title:"请求失败",desc:""})})},loadResource:function(){bus.$emit("on-loading");var e=this;this.$Util.api.get(i.resource,e).then(function(t){bus.$emit("on-loading"),e.existModules=t.data.moduleSubModules},function(t){bus.$emit("on-loading"),e.$Notice.warning({title:"加载资源失败",desc:""})})},loadCodeMaker:function(){bus.$emit("on-loading");var e=this;this.$Util.api.get(i.find,e).then(function(e){bus.$emit("on-loading"),this.formItem.id=e.data.id,this.formItem.name=e.data.name},function(t){bus.$emit("on-loading"),e.$Notice.warning({title:"加载codeMaker详情失败",desc:""})})}},created:function(){window.a=this,this.$nextTick(function(){this.loadResource()})}}},oXbB:function(e,t,o){var i=o("VU/8")(o("HJeG"),o("5FOW"),null,null);e.exports=i.exports}});