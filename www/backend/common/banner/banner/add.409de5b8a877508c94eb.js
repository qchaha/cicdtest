webpackJsonp([18],{"+jGz":function(e,t,n){var i=n("zyPr");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("0d7583ce",i,!0)},"/mu8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"MOrientPut",props:{audiences:{type:Array,name:function(){return[]}}},data:function(){return{formItem:{audience:"",platforms:["in_ios","in_android","in_h5"]}}},watch:{formItem:{handler:function(e,t){this.$emit("on-data-change",e)},deep:!0}}}},"0MJf":function(e,t,n){n("Gz6+");var i=n("VU/8")(n("7rD0"),n("0VrU"),"data-v-3a596936",null);e.exports=i.exports},"0VrU":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("m-card",[n("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("广告位")]),e._v(" "),e._l(e.items,function(t,i){return n("div",[n("div",{staticClass:"el"},[n("m-banner-el",{attrs:{index:i,elItem:t,positions:e.positions,groups:e.groups},on:{"get-item":e.getItem}})],1),e._v(" "),n("div",{staticClass:"delete"},[n("Button",{staticStyle:{"background-color":"#fff"},attrs:{type:"ghost"},on:{click:function(t){e.handleDelete(i)}}},[e._v("删除")])],1)])}),e._v(" "),n("div",{staticClass:"add"},[n("Row",{attrs:{span:"8"}},[n("i-col",{attrs:{span:"8"}},[n("Button",{attrs:{type:"ghost",long:"",icon:"plus-round"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1)],2)},staticRenderFns:[]}},"4Gn8":function(e,t,n){var i=n("VU/8")(n("/mu8"),n("I5MF"),null,null);e.exports=i.exports},"53Hh":function(e,t,n){t=e.exports=n(0)(),t.push([e.i,".time[data-v-cfd7d382]{display:inline-block;width:200px}.delete[data-v-cfd7d382]{display:inline-block}.banner-el[data-v-cfd7d382]{background-color:#ddd;padding:20px;margin:5px 0}[class*=span][data-v-cfd7d382]{margin-left:0}",""])},"67VK":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("m-page",[n("m-base-information",{on:{"on-data-change":e.getBaseInformationData}}),e._v(" "),n("m-orient-put",{attrs:{audiences:e.audiences},on:{"on-data-change":e.getOrientPutData}}),e._v(" "),n("m-banner",{attrs:{positions:e.positions,groups:e.groups},on:{"on-data-change":e.getBannerData}}),e._v(" "),n("m-card",[n("Button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)],1)},staticRenderFns:[]}},"7rD0":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("YL94"),a=n.n(i);t.default={name:"MBanner",components:{MBannerEl:a.a},props:{positions:{type:Array,name:function(){return[]}},groups:{type:Array,name:function(){return[]}}},data:function(){return{items:[{title:"",posCode:"",groupId:[],imageUrl:[],height:0,width:0,displayProbability:100,weight:1,times:[{beginTime:0,endTime:0}]}]}},watch:{items:{handler:function(e,t){this.$emit("on-data-change",e)},deep:!0}},methods:{handleDelete:function(e){this.items.splice(e,1)},handleAdd:function(){this.items.push({title:"",posCode:"",groupId:[],imageUrl:[],height:0,width:0,displayProbability:100,weight:1,times:[{beginTime:0,endTime:0}]})},getItem:function(e,t){this.items[e]=t}}}},Aeu7:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"banner-el"},[n("Form",{attrs:{model:e.formItem,"label-width":80}},[n("Form-item",{attrs:{label:"投放位置"}},[n("Select",{staticStyle:{width:"200px"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.formItem.posCode,callback:function(t){e.$set(e.formItem,"posCode",t)},expression:"formItem.posCode"}},e._l(e.positions,function(t){return n("Option",{key:t.id,attrs:{value:t.pos_code}},[e._v(e._s(t.name))])})),e._v(" "),"mjb_group_s"===e.formItem.posCode?n("Select",{staticStyle:{width:"200px"},attrs:{multiple:"",clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.formItem.groupId,callback:function(t){e.$set(e.formItem,"groupId",t)},expression:"formItem.groupId"}},e._l(e.groups,function(t){return n("Option",{key:t.group_id,attrs:{value:t.group_id}},[e._v(e._s(t.name))])})):e._e()],1),e._v(" "),n("Form-item",{directives:[{name:"show",rawName:"v-show",value:"course_subject"===e.formItem.posCode,expression:"formItem.posCode==='course_subject'"}],attrs:{label:"展示标题"}},[n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"展示标题"},model:{value:e.formItem.title,callback:function(t){e.$set(e.formItem,"title",t)},expression:"formItem.title"}})],1),e._v(" "),n("Form-item",{attrs:{label:"图片"}},[n("m-upload-image",{attrs:{"default-images":e.formItem.imgUrl},on:{"on-success":e.getImageUrl}})],1),e._v(" "),"share_recommend_activity"===e.formItem.posCode||"course_detail"===e.formItem.posCode?n("Form-item",{attrs:{label:"显示概率"}},[n("Input-number",{staticStyle:{width:"200px"},attrs:{max:100,min:1,placeholder:"概率"},model:{value:e.formItem.displayProbability,callback:function(t){e.$set(e.formItem,"displayProbability",t)},expression:"formItem.displayProbability"}})],1):e._e(),e._v(" "),e._e(),e._v(" "),e._l(e.formItem.times,function(t,i){return n("Form-item",{attrs:{label:"投放时间"}},[n("Row",[n("div",{staticClass:"time"},[n("Date-picker",{attrs:{type:"datetime",placeholder:"选择开始日期"},model:{value:t.beginTime,callback:function(n){e.$set(t,"beginTime",n)},expression:"item.beginTime"}})],1),e._v(" "),n("div",{staticClass:"time"},[n("Date-picker",{attrs:{type:"datetime",placeholder:"选择结束日期"},model:{value:t.endTime,callback:function(n){e.$set(t,"endTime",n)},expression:"item.endTime"}})],1),e._v(" "),n("div",{staticClass:"delete"},[n("Button",{staticStyle:{"background-color":"#fff"},attrs:{type:"ghost"},on:{click:function(t){e.handleDelete(i)}}},[e._v("删除")])],1)])],1)}),e._v(" "),n("Form-item",[n("Row",{attrs:{span:"8"}},[n("i-col",{attrs:{span:"8"}},[n("Button",{staticStyle:{"background-color":"#fff"},attrs:{type:"ghost",long:"",icon:"plus-round"},on:{click:e.handleAdd}},[e._v("新增")])],1)],1)],1)],2)],1)},staticRenderFns:[]}},CKle:function(e,t,n){var i=n("VU/8")(n("Wdfo"),n("67VK"),null,null);e.exports=i.exports},"Gz6+":function(e,t,n){var i=n("W+oj");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("71910489",i,!0)},I5MF:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("m-card",[n("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("定向投放")]),e._v(" "),n("Form",{attrs:{model:e.formItem,"label-width":80}},[n("Form-item",{attrs:{label:"展示对象"}},[n("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",filterable:"",placeholder:"请选择"},model:{value:e.formItem.audience,callback:function(t){e.$set(e.formItem,"audience",t)},expression:"formItem.audience"}},e._l(e.audiences,function(t){return n("Option",{key:t.id,attrs:{value:t.audience}},[e._v(e._s(t.title))])}))],1),e._v(" "),n("Form-item",{attrs:{label:"版本"}},[n("Checkbox-group",{model:{value:e.formItem.platforms,callback:function(t){e.$set(e.formItem,"platforms",t)},expression:"formItem.platforms"}},[n("Checkbox",{attrs:{label:"in_ios"}},[e._v("iOS")]),e._v(" "),n("Checkbox",{attrs:{label:"in_android"}},[e._v("Android")]),e._v(" "),n("Checkbox",{attrs:{label:"in_h5"}},[e._v("H5")])],1)],1)],1)],1)},staticRenderFns:[]}},TiDG:function(e,t,n){n("+jGz");var i=n("VU/8")(n("rUz5"),n("dwVr"),"data-v-c0499dae",null);e.exports=i.exports},"W+oj":function(e,t,n){t=e.exports=n(0)(),t.push([e.i,".delete[data-v-3a596936],.el[data-v-3a596936]{display:inline-block;vertical-align:top}[class*=span][data-v-3a596936]{margin-left:0}",""])},Wdfo:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("TiDG"),a=n.n(i),r=n("4Gn8"),o=n.n(r),s=n("0MJf"),l=n.n(s),m={create:{api:{path:"/boss/common/banner/banner/create"}},resource:{api:{path:"/boss/common/banner/banner/add-page-info",params:{fields:"{positions{id,pos_code,name},audiences{id,title,audience},groups{group_id,name}}"}}}};t.default={name:"add",components:{MBaseInformation:a.a,MOrientPut:o.a,MBanner:l.a},data:function(){return{positions:[],audiences:[],groups:[],base:{},orient:{inIos:1,inAndroid:1,inH5:1},banner:{}}},methods:{back:function(){location.hash="/common/banner/banner/list"},loadResource:function(){bus.$emit("on-loading");var e=this;this.$Util.api.get(m.resource,e).then(function(t){bus.$emit("on-loading"),e.positions=t.data.form.positions,e.audiences=t.data.form.audiences,e.groups=t.data.form.groups},function(t){bus.$emit("on-loading"),e.$Message.warning("加载资源失败")})},getBaseInformationData:function(e){this.base=e},getOrientPutData:function(e){e.inIos=e.platforms.includes("in_ios")?1:0,e.inAndroid=e.platforms.includes("in_android")?1:0,e.inH5=e.platforms.includes("in_h5")?1:0,this.orient=e},getBannerData:function(e){this.banners=e},errorMessage:function(e){this.$Notice.error({title:e})},submit:function(){if(this.validateFormData()){var e=this.getRequestParams();this.submitRequest(e)}},validateFormData:function(){if(""===this.base.name||void 0===this.base.name)return this.errorMessage("请填写活动名称"),!1;if(this.banners==={}||void 0===this.banners)return this.errorMessage("广告位信息不能为空"),!1;for(var e in this.banners){if(0===this.banners[e].posCode.length){var t=parseInt(e)+1;return this.errorMessage("第"+t+"个广告位需要填投放位置"),!1}if("mjb_group_s"===this.banners[e].posCode&&0===this.banners[e].groupId.length)return this.errorMessage("社区小广告需要选择小组"),!1;if(void 0===this.banners[e].imgUrl||0===this.banners[e].imgUrl.length){var n=parseInt(e)+1;return this.errorMessage("第"+n+"个广告位需要上传图片"),!1}var i=this.banners[e].times,a=parseInt(e)+1;for(var r in i)if((""!==i[r].endTime||void 0!==i[r].endTime)&&Date.parse(i[r].beginTime)>=Date.parse(i[r].endTime))return this.errorMessage("第"+a+"个广告位开始时间不能大于结束时间"),!1}return!0},getRequestParams:function(){return{name:this.base.name,appRoute:this.base.appRoute||"",audience:this.orient.audience||"",inIos:this.orient.inIos,inAndroid:this.orient.inAndroid,inH5:this.orient.inH5,banners:this.banners}},submitRequest:function(e){bus.$emit("on-loading");var t=this;this.$Util.api.post(m.create,JSON.stringify(e),t).then(function(){t.$Message.success("请求成功"),t.back()},function(e){bus.$emit("on-loading"),t.$Message.warning("请求失败")})}},created:function(){this.$nextTick(function(){this.loadResource()})}}},YL94:function(e,t,n){n("sdP3");var i=n("VU/8")(n("s9v1"),n("Aeu7"),"data-v-cfd7d382",null);e.exports=i.exports},dwVr:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("m-card",[n("h3",{staticStyle:{"margin-bottom":"10px"}},[e._v("基本信息")]),e._v(" "),n("Form",{attrs:{model:e.formItem,"label-width":80}},[n("Form-item",{attrs:{label:"名称"}},[n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"名称"},model:{value:e.formItem.name,callback:function(t){e.$set(e.formItem,"name",t)},expression:"formItem.name"}})],1),e._v(" "),n("Form-item",{attrs:{label:"路由"}},[n("m-app-route",{model:{value:e.formItem.appRoute,callback:function(t){e.$set(e.formItem,"appRoute",t)},expression:"formItem.appRoute"}})],1)],1)],1)},staticRenderFns:[]}},rUz5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"MBaseInformation",data:function(){return{modal:!1,formItem:{name:"",appRoute:""}}},watch:{formItem:{handler:function(e,t){this.$emit("on-data-change",e)},deep:!0}},methods:{edit:function(){this.modal=!0}}}},s9v1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"MBannerEl",props:{index:{type:Number,name:0},elItem:{type:Object,name:function(){return{}}},positions:{type:Array,name:function(){return[]}},groups:{type:Array,name:function(){return[]}}},watch:{formItem:{handler:function(e,t){this.$emit("get-item",this.index,e)},deep:!0},elItem:{handler:function(e,t){e!==t&&(this.formItem=e)},deep:!0}},data:function(){return{elIndex:this.index,formItem:{title:this.elItem.title,posCode:this.elItem.posCode,groupId:this.elItem.groupId,imgUrl:this.elItem.imgUrl,height:this.elItem.height,width:this.elItem.width,displayProbability:this.elItem.displayProbability,weight:this.elItem.weight,times:this.elItem.times}}},methods:{handleDelete:function(e){this.formItem.times.splice(e,1)},handleAdd:function(){this.formItem.times.push({beginTime:0,endTime:0})},getImageUrl:function(e){this.formItem.imgUrl=[{url:e[0].url||""}],this.formItem.height=parseInt(e[0].height)||0,this.formItem.width=parseInt(e[0].width)||0}}}},sdP3:function(e,t,n){var i=n("53Hh");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("172e8710",i,!0)},zyPr:function(e,t,n){t=e.exports=n(0)(),t.push([e.i,".route[data-v-c0499dae]{display:inline-block;max-width:200px;overflow:hidden;white-space:nowrap;vertical-align:middle}",""])}});