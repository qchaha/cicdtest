webpackJsonp([167],{KCDx:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("m-config-form",{attrs:{usage:"edit",id:t.id}})},staticRenderFns:[]}},WwJ2:function(t,e,i){var r=i("VU/8")(i("kdYX"),i("KCDx"),null,null);t.exports=r.exports},a9BP:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("m-card",[i("Form",{attrs:{model:t.formItem,rules:t.ruleItem,"label-width":80}},[i("Form-item",{attrs:{label:"活动名称",prop:"name"}},[i("Input",{staticStyle:{width:"400px"},model:{value:t.formItem.name,callback:function(e){t.$set(t.formItem,"name",e)},expression:"formItem.name"}})],1),t._v(" "),i("Form-item",{attrs:{label:"备注"}},[i("Input",{staticStyle:{width:"400px"},model:{value:t.formItem.memo,callback:function(e){t.$set(t.formItem,"memo",e)},expression:"formItem.memo"}})],1),t._v(" "),i("Form-item",{attrs:{label:"配置",prop:"config"}},[i("Input",{staticStyle:{width:"400px"},attrs:{type:"textarea"},model:{value:t.formItem.config,callback:function(e){t.$set(t.formItem,"config",e)},expression:"formItem.config"}})],1),t._v(" "),i("Button",{attrs:{type:"primary",disabled:t.submitEnable},on:{click:t.submit}},[t._v("提交")])],1)],1)},staticRenderFns:[]}},kdYX:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("zQC7"),o=i.n(r);e.default={name:"edit",components:{MConfigForm:o.a},data:function(){return{id:this.$route.params.id}}}},q4NO:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={create:{api:{path:"/boss/activity/common/form/create"}},edit:{api:{path:"/boss/activity/common/form/edit",params:{id:"",fields:"{name,config,memo}"}}},update:{api:{path:"/boss/activity/common/form/update"}},resource:{api:{path:"/boss/activity/common/form/add-page-info",params:{fields:"{name,config,memo}"}}}};e.default={name:"MConfigForm",props:{id:{type:String,default:""},usage:{type:String,default:"edit"}},data:function(){return{submitEnable:!1,formItem:{name:"",config:"",memo:""},ruleItem:{name:[{required:!0,message:"请填写活动名称",trigger:"blur"}],config:[{required:!0,message:"请填写配置",trigger:"blur"}]}}},methods:{back:function(){location.hash="/activity/common/form/find-list"},errorMessage:function(t){this.$Notice.error({title:t})},submit:function(){if(""===this.formItem.name||void 0===this.formItem.name)return this.errorMessage("请填写活动名称"),!1;if(""===this.formItem.config||void 0===this.formItem.config)return this.errorMessage("请输入表单配置"),!1;bus.$emit("on-loading");var t={};t={name:this.formItem.name,memo:this.formItem.memo,config:this.formItem.config};var e={};"edit"===this.usage?(t.id=this.id,e=r.update):e=r.create;var i=this;this.$Util.api.post(e,JSON.stringify(t),i).then(function(t){bus.$emit("on-loading"),0===t.error_code?i.back():(i.submitEnable=!1,i.errorMessage("数据错误，请检查"))},function(t){})},loadFormData:function(t){r.edit.api.params.id=t;var e=this;this.$Util.api.get(r.edit,this).then(function(t){if(bus.$emit("on-loading"),!t.data)return e.$Message.warning("没有数据"),!1;e.formItem=t.data,e.formItem.config=unescape(t.data.config.replace(/\\u/g,"%u"))},function(t){e.$Message.warning("数据加载失败，请重试")})}},created:function(){var t=this;this.$nextTick(function(){if("edit"==t.usage){bus.$emit("on-loading");var e=this.id;if(this.formItem.id=e,!parseInt(this.formItem.id))return this.errorMessage("表单id有误"),!1;this.loadFormData(e)}})}}},zQC7:function(t,e,i){var r=i("VU/8")(i("q4NO"),i("a9BP"),null,null);t.exports=r.exports}});